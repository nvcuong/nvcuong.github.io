<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Quasi-Likelihood methods | Advanced Statistical Modelling III (second term)</title>
  <meta name="description" content="These are the course notes for the module Advanced Statistical Modelling III of Durham University’s degree for Mathematics and Statistics." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Quasi-Likelihood methods | Advanced Statistical Modelling III (second term)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These are the course notes for the module Advanced Statistical Modelling III of Durham University’s degree for Mathematics and Statistics." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Quasi-Likelihood methods | Advanced Statistical Modelling III (second term)" />
  
  <meta name="twitter:description" content="These are the course notes for the module Advanced Statistical Modelling III of Durham University’s degree for Mathematics and Statistics." />
  

<meta name="author" content="Dr. Cuong Nguyen" />


<meta name="date" content="2024-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="deviance_and_diagnostics.html"/>
<link rel="next" href="marginal_models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Statistical Modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Module Information</a></li>
<li class="chapter" data-level="1" data-path="generalised_linear_models.html"><a href="generalised_linear_models.html"><i class="fa fa-check"></i><b>1</b> Review of Generalised Linear Models</a></li>
<li class="chapter" data-level="2" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estimation.html"><a href="estimation.html#likelihood"><i class="fa fa-check"></i><b>2.1</b> Likelihood</a></li>
<li class="chapter" data-level="2.2" data-path="estimation.html"><a href="estimation.html#loglike"><i class="fa fa-check"></i><b>2.2</b> Log-Likelihood</a></li>
<li class="chapter" data-level="2.3" data-path="estimation.html"><a href="estimation.html#score-function-and-equation"><i class="fa fa-check"></i><b>2.3</b> Score Function and Equation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="estimation.html"><a href="estimation.html#natural-link"><i class="fa fa-check"></i><b>2.3.1</b> Natural Link</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="estimation.html"><a href="estimation.html#fisherinformation"><i class="fa fa-check"></i><b>2.4</b> Fisher Information</a></li>
<li class="chapter" data-level="2.5" data-path="estimation.html"><a href="estimation.html#example-poisson-regression"><i class="fa fa-check"></i><b>2.5</b> Example: Poisson Regression</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="estimation.html"><a href="estimation.html#with-natural-link"><i class="fa fa-check"></i><b>2.5.1</b> With Natural Link</a></li>
<li class="chapter" data-level="2.5.2" data-path="estimation.html"><a href="estimation.html#with-identity-link"><i class="fa fa-check"></i><b>2.5.2</b> With Identity Link</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="estimation.html"><a href="estimation.html#properties-of-boldsymbolsboldsymbolbeta-and-boldsymbolfboldsymbolbeta"><i class="fa fa-check"></i><b>2.6</b> Properties of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span> and <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span></a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="estimation.html"><a href="estimation.html#expectation-of-boldsymbolsboldsymbolbeta"><i class="fa fa-check"></i><b>2.6.1</b> Expectation of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span></a></li>
<li class="chapter" data-level="2.6.2" data-path="estimation.html"><a href="estimation.html#variance-of-boldsymbolsboldsymbolbeta"><i class="fa fa-check"></i><b>2.6.2</b> Variance of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span></a></li>
<li class="chapter" data-level="2.6.3" data-path="estimation.html"><a href="estimation.html#boldsymbolfboldsymbolbeta"><i class="fa fa-check"></i><b>2.6.3</b> <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="estimation.html"><a href="estimation.html#matrix-notation"><i class="fa fa-check"></i><b>2.7</b> Matrix Notation</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="estimation.html"><a href="estimation.html#score-function-and-fisher-information"><i class="fa fa-check"></i><b>2.7.1</b> Score Function and Fisher Information</a></li>
<li class="chapter" data-level="2.7.2" data-path="estimation.html"><a href="estimation.html#natural-link-2"><i class="fa fa-check"></i><b>2.7.2</b> Natural Link</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="estimation.html"><a href="estimation.html#iterativesolution"><i class="fa fa-check"></i><b>2.8</b> Iterative Solution of <span class="math inline">\(\boldsymbol{S}(\hat{\boldsymbol{\beta}}) = 0\)</span></a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="estimation.html"><a href="estimation.html#irls-pseudo-code"><i class="fa fa-check"></i><b>2.8.1</b> IRLS Pseudo-Code</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="estimation.html"><a href="estimation.html#practical-example-dataset-b-us-polio-data"><i class="fa fa-check"></i><b>2.9</b> Practical Example: Dataset B: US Polio Data</a></li>
<li class="chapter" data-level="2.10" data-path="estimation.html"><a href="estimation.html#estimation-of-phi"><i class="fa fa-check"></i><b>2.10</b> Estimation of <span class="math inline">\(\phi\)</span></a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="estimation.html"><a href="estimation.html#special-cases"><i class="fa fa-check"></i><b>2.10.1</b> Special Cases</a></li>
<li class="chapter" data-level="2.10.2" data-path="estimation.html"><a href="estimation.html#practical-example-dataset-c-hospital-data"><i class="fa fa-check"></i><b>2.10.2</b> Practical Example: Dataset C: Hospital Data</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="estimation.html"><a href="estimation.html#asymptotic-properties-of-hatboldsymbolbeta"><i class="fa fa-check"></i><b>2.11</b> Asymptotic Properties of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="estimation.html"><a href="estimation.html#fisher-scoring"><i class="fa fa-check"></i><b>2.11.1</b> Fisher Scoring</a></li>
<li class="chapter" data-level="2.11.2" data-path="estimation.html"><a href="estimation.html#expectation"><i class="fa fa-check"></i><b>2.11.2</b> Expectation</a></li>
<li class="chapter" data-level="2.11.3" data-path="estimation.html"><a href="estimation.html#variance"><i class="fa fa-check"></i><b>2.11.3</b> Variance</a></li>
<li class="chapter" data-level="2.11.4" data-path="estimation.html"><a href="estimation.html#asymptotic-normality"><i class="fa fa-check"></i><b>2.11.4</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="2.11.5" data-path="estimation.html"><a href="estimation.html#closing-the-circle"><i class="fa fa-check"></i><b>2.11.5</b> Closing The Circle</a></li>
<li class="chapter" data-level="2.11.6" data-path="estimation.html"><a href="estimation.html#next-step"><i class="fa fa-check"></i><b>2.11.6</b> Next Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html"><i class="fa fa-check"></i><b>3</b> Prediction and Inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#prediction2"><i class="fa fa-check"></i><b>3.1</b> Prediction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#example-dataset-b"><i class="fa fa-check"></i><b>3.1.1</b> Example: Dataset B</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#hypothesis-tests"><i class="fa fa-check"></i><b>3.2</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#simple-tests"><i class="fa fa-check"></i><b>3.2.1</b> Simple Tests</a></li>
<li class="chapter" data-level="3.2.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#generalisation-to-nested-models"><i class="fa fa-check"></i><b>3.2.2</b> Generalisation to Nested Models</a></li>
<li class="chapter" data-level="3.2.3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#example-dataset-c"><i class="fa fa-check"></i><b>3.2.3</b> Example: Dataset C</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#confidence-regions-for-hatboldsymbolbeta"><i class="fa fa-check"></i><b>3.3</b> Confidence Regions for <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#alpha-hessian-cr"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\((1 - \alpha)\)</span> Hessian CR</a></li>
<li class="chapter" data-level="3.3.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#alpha-method-of-support-cr"><i class="fa fa-check"></i><b>3.3.2</b> <span class="math inline">\((1 - \alpha)\)</span> <em>method of support</em> CR</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#issues-with-glms-and-the-wald-test"><i class="fa fa-check"></i><b>3.4</b> Issues with GLMs and the Wald Test</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#separation"><i class="fa fa-check"></i><b>3.4.1</b> Separation</a></li>
<li class="chapter" data-level="3.4.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#hauck-donner-effect"><i class="fa fa-check"></i><b>3.4.2</b> Hauck-Donner Effect</a></li>
<li class="chapter" data-level="3.4.3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#next-step-1"><i class="fa fa-check"></i><b>3.4.3</b> Next Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html"><i class="fa fa-check"></i><b>4</b> Deviance</a>
<ul>
<li class="chapter" data-level="4.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#goodness-of-fit"><i class="fa fa-check"></i><b>4.1</b> Goodness-of-Fit</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#saturated-model"><i class="fa fa-check"></i><b>4.1.1</b> Saturated Model</a></li>
<li class="chapter" data-level="4.1.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#deviance"><i class="fa fa-check"></i><b>4.1.2</b> Deviance</a></li>
<li class="chapter" data-level="4.1.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-special-cases"><i class="fa fa-check"></i><b>4.1.3</b> Example Special Cases</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#asymptotic-properties"><i class="fa fa-check"></i><b>4.2</b> Asymptotic Properties</a></li>
<li class="chapter" data-level="4.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#pearson-statistic"><i class="fa fa-check"></i><b>4.3</b> Pearson Statistic</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#relation-to-deviance"><i class="fa fa-check"></i><b>4.3.1</b> Relation to Deviance</a></li>
<li class="chapter" data-level="4.3.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#pearson-residuals"><i class="fa fa-check"></i><b>4.3.2</b> Pearson Residuals</a></li>
<li class="chapter" data-level="4.3.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-b-1"><i class="fa fa-check"></i><b>4.3.3</b> Example: Dataset B</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#residuals-and-diagnostics"><i class="fa fa-check"></i><b>4.4</b> Residuals and Diagnostics</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-c-1"><i class="fa fa-check"></i><b>4.4.1</b> Example: Dataset C</a></li>
<li class="chapter" data-level="4.4.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-b-2"><i class="fa fa-check"></i><b>4.4.2</b> Example: Dataset B</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#analysis-of-deviance"><i class="fa fa-check"></i><b>4.5</b> Analysis of Deviance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#interpretation-and-testing"><i class="fa fa-check"></i><b>4.5.1</b> Interpretation and Testing</a></li>
<li class="chapter" data-level="4.5.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#general-case"><i class="fa fa-check"></i><b>4.5.2</b> General Case</a></li>
<li class="chapter" data-level="4.5.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-c-2"><i class="fa fa-check"></i><b>4.5.3</b> Example: Dataset C</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html"><i class="fa fa-check"></i><b>5</b> Quasi-Likelihood methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#dispersion"><i class="fa fa-check"></i><b>5.1</b> Dispersion</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.1-hospital-stay-data"><i class="fa fa-check"></i><b>5.1.1</b> Example 5.1 (Hospital stay data)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#overdispersion"><i class="fa fa-check"></i><b>5.2</b> Overdispersion</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.2-us-polio-data"><i class="fa fa-check"></i><b>5.2.1</b> Example 5.2 (US Polio data)</a></li>
<li class="chapter" data-level="5.2.2" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.3-us-polio-data"><i class="fa fa-check"></i><b>5.2.2</b> Example 5.3 (US Polio data)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#generalized-estimating-equations"><i class="fa fa-check"></i><b>5.3</b> Generalized estimating equations</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.4"><i class="fa fa-check"></i><b>5.3.1</b> Example 5.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="marginal_models.html"><a href="marginal_models.html"><i class="fa fa-check"></i><b>6</b> Marginal models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="marginal_models.html"><a href="marginal_models.html#repeated-measures-data"><i class="fa fa-check"></i><b>6.1</b> Repeated measures data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="marginal_models.html"><a href="marginal_models.html#example-6.1-oxford-boys-data"><i class="fa fa-check"></i><b>6.1.1</b> Example 6.1 (Oxford boys data)</a></li>
<li class="chapter" data-level="6.1.2" data-path="marginal_models.html"><a href="marginal_models.html#example-6.2-mathematics-achievement-data"><i class="fa fa-check"></i><b>6.1.2</b> Example 6.2 (Mathematics achievement data)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="marginal_models.html"><a href="marginal_models.html#the-marginal-model-for-repeated-measures"><i class="fa fa-check"></i><b>6.2</b> The marginal model for repeated measures</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="marginal_models.html"><a href="marginal_models.html#example-6.3"><i class="fa fa-check"></i><b>6.2.1</b> Example 6.3</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="marginal_models.html"><a href="marginal_models.html#estimation-1"><i class="fa fa-check"></i><b>6.3</b> Estimation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="marginal_models.html"><a href="marginal_models.html#example-6.4"><i class="fa fa-check"></i><b>6.3.1</b> Example 6.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html"><i class="fa fa-check"></i><b>7</b> Linear mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#random-intercept-models"><i class="fa fa-check"></i><b>7.1</b> Random intercept models</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.1-oxford-boys-data"><i class="fa fa-check"></i><b>7.1.1</b> Example 7.1 (Oxford boys data)</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.2-oxford-boys-data"><i class="fa fa-check"></i><b>7.1.2</b> Example 7.2 (Oxford boys data)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#random-slope-models"><i class="fa fa-check"></i><b>7.2</b> Random slope models</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.3-oxford-boys"><i class="fa fa-check"></i><b>7.2.1</b> Example 7.3 (Oxford boys)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#the-linear-mixed-model-lmm"><i class="fa fa-check"></i><b>7.3</b> The Linear Mixed Model (LMM)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.4"><i class="fa fa-check"></i><b>7.3.1</b> Example 7.4</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#estimation-of-fixed-effects"><i class="fa fa-check"></i><b>7.4</b> Estimation of fixed effects</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.5"><i class="fa fa-check"></i><b>7.4.1</b> Example 7.5</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#inference-for-fixed-effects"><i class="fa fa-check"></i><b>7.5</b> Inference for fixed effects</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.6-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.5.1</b> Example 7.6 (Mathematics achievement data)</a></li>
<li class="chapter" data-level="7.5.2" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.7-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.5.2</b> Example 7.7 (Mathematics achievement data)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#prediction-of-random-effects"><i class="fa fa-check"></i><b>7.6</b> Prediction of random effects</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.8-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.6.1</b> Example 7.8 (Mathematics achievement data)</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#inference-for-random-effects"><i class="fa fa-check"></i><b>7.7</b> Inference for random effects</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.9-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.7.1</b> Example 7.9 (Mathematics achievement data)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Statistical Modelling III (second term)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quasi_likelihood" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Quasi-Likelihood methods<a href="quasi_likelihood.html#quasi_likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="dispersion" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Dispersion<a href="quasi_likelihood.html#dispersion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall the exponential dispersion family</p>
<p><span class="math display">\[
P(y_i|\theta_i, \phi_i)= \exp\left\{\frac{y_i\theta_i-b(\theta_i)}{\phi_i}+c(y_i, \phi_i)\right\}.
\]</span></p>
<p>Assume grouping has been taken care of, that is <span class="math inline">\(\phi_i=\phi/m_i\)</span> and so</p>
<p><span class="math display">\[
P(y_i|\theta_i, \phi)= \exp\left\{ \frac{y_i\theta_i-b(\theta_i)}{\phi}+c(y_i, \phi, m_i)\right\}.
\]</span>
Basic property (directly from GLM theory, see Section 6.2.2):</p>
<p><span class="math display">\[
\mbox{Var}(y_i|\theta_i, \phi_i)= \phi_i\mathcal{V}(\mu_i)= \phi\mathcal{V}(\mu_i)/m_i
\]</span>
So, dispersion <span class="math inline">\(\phi\)</span> scales the variance but does but does not affect <span class="math inline">\(E(y_i| \theta_i,\phi_i)=\mu_i=h(\boldsymbol{x}_i^T\boldsymbol{\beta})\)</span>.</p>
<p>We know that the function <span class="math inline">\(\mathcal{V}(\mu)\)</span> is characteristic for the response distribution at play:</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(Y\)</span></th>
<th><span class="math inline">\(\mathcal{V}(\mu)\)</span></th>
<th><span class="math inline">\(\phi\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(N(\mu, \sigma^2)\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mbox{Bernoulli}(p)\)</span></td>
<td><span class="math inline">\(p(1-p)\)</span></td>
<td><span class="math inline">\(1\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mbox{Poisson}(\mu)\)</span></td>
<td><span class="math inline">\(\mu\)</span></td>
<td><span class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mbox{Gamma}(\mu, \nu)\)</span></td>
<td><span class="math inline">\(\mu^2\)</span></td>
<td><span class="math inline">\(1/\nu\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(IG(\mu, \sigma^2)\)</span></td>
<td><span class="math inline">\(\mu^3\)</span></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
</tr>
</tbody>
</table>
<p>What is then the relevance of dispersion?</p>
<p>For estimation of <span class="math inline">\(\boldsymbol{\beta}\)</span>, we note from (8.17)</p>
<p><span class="math display">\[
S(\boldsymbol{\beta})= \frac{1}{\phi}\sum_{i=1}^n m_i \left\{...\right\} \stackrel{!}{=}0
\]</span></p>
<p>that is <span class="math inline">\(\phi\)</span> cancels out when setting the score-function to 0. Hence, dispersion is irrelevant for the estimation of <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p>
<p>But for the variance of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> we have
<span class="math display">\[
\mbox{Var}(\hat{\boldsymbol{\beta}})= F_{(\phi)}^{-1}(\hat{\boldsymbol{\beta}}) )= \left[ \frac{1}{\phi}\sum_{i=1}^{n} m_i \left\{\ldots\right\}\right]^{-1} = \phi F_{(\phi=1)}^{-1}(\hat{\boldsymbol{\beta}})
\]</span>
where <span class="math inline">\(F_{(\phi)}(\cdot)\)</span> is the (expected) Fisher information when using dispersion <span class="math inline">\(\phi\)</span>.</p>
<p>This result implies that a dispersion of <span class="math inline">\(\phi\)</span> will inflate all standard errors, <span class="math inline">\(SE(\hat{\beta}_j)\)</span>,
by the factor <span class="math inline">\(\sqrt{\phi}\)</span> (when compared to using <span class="math inline">\(\phi=1\)</span>).</p>
<p>Estimation of dispersion can be motivated through goodness-of-fit statistics (see also Sec 8.6):</p>
<ul>
<li>via Pearson goodness-of-fit statistic <span class="math inline">\(\chi^2_P= \sum_{i=1}^nm_i\frac{(y_i-\hat{\mu}_i)^2}{\mathcal{V}(\hat{\mu}_i)}\)</span>:
<span class="math display">\[
\begin{aligned}
\chi^2_P \stackrel{a}{\sim} \phi \chi^2(n-p)\\
E(\chi^2_P)= \phi \times (n-p)
\end{aligned}
\]</span>
suggesting
<span class="math display">\[
\hat{\phi}_{\mbox{Pearson}}= \frac{1}{n-p} \chi^2_P
\]</span></li>
<li>via Deviance, <span class="math inline">\(D(\boldsymbol{Y}, \hat{\boldsymbol{\mu}}) =2\phi(\ell_{sat}-\ell(\hat{\boldsymbol{\beta}}))\)</span>:
<span class="math display">\[
\begin{aligned}
D(\boldsymbol{Y}, \hat{\boldsymbol{\mu}})\stackrel{a}{\sim} \phi \chi^2(n-p)\\
E(D(\boldsymbol{Y}, \hat{\boldsymbol{\mu}}))= \phi \times (n-p)
\end{aligned}
\]</span>
suggesting
<span class="math display">\[
\hat{\phi}_{\mbox{dev}}= \frac{D(\boldsymbol{Y}, \hat{\boldsymbol{\mu}})}{n-p}
\]</span>
The notation <span class="math inline">\(a\)</span> in the distributional expressions highlights that these are just approximations. For the deviance, we know that the approximation can be very poor! Therefore the deviance-based estimate is sometimes called the “quick-and-dirty” dispersion estimate.</li>
</ul>
<div id="example-5.1-hospital-stay-data" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Example 5.1 (Hospital stay data)<a href="quasi_likelihood.html#example-5.1-hospital-stay-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="quasi_likelihood.html#cb69-1" tabindex="-1"></a><span class="fu">require</span>(npmlreg)</span>
<span id="cb69-2"><a href="quasi_likelihood.html#cb69-2" tabindex="-1"></a><span class="fu">data</span>(hosp)</span>
<span id="cb69-3"><a href="quasi_likelihood.html#cb69-3" tabindex="-1"></a><span class="fu">plot</span>(hosp[,<span class="fu">c</span>(<span class="st">&quot;duration&quot;</span>,<span class="st">&quot;age&quot;</span>,<span class="st">&quot;temp1&quot;</span>,<span class="st">&quot;wbc1&quot;</span>)])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="quasi_likelihood.html#cb70-1" tabindex="-1"></a>hosp.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(duration<span class="sc">~</span>age<span class="sc">+</span>temp1, <span class="at">data=</span>hosp, <span class="at">family=</span><span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb70-2"><a href="quasi_likelihood.html#cb70-2" tabindex="-1"></a><span class="fu">summary</span>(hosp.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = duration ~ age + temp1, family = Gamma(link = log), 
##     data = hosp)
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -28.654096  16.621018  -1.724   0.0987 .
## age           0.014900   0.005698   2.615   0.0158 *
## temp1         0.306624   0.168141   1.824   0.0818 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.2690233)
## 
##     Null deviance: 8.1722  on 24  degrees of freedom
## Residual deviance: 5.7849  on 22  degrees of freedom
## AIC: 142.73
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Dispersion estimate (Pearson):</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="quasi_likelihood.html#cb72-1" tabindex="-1"></a>hosp.disp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(hosp.glm<span class="sc">$</span>df.res)<span class="sc">*</span><span class="fu">sum</span>( (hosp<span class="sc">$</span>duration<span class="sc">-</span>hosp.glm<span class="sc">$</span>fitted)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(hosp.glm<span class="sc">$</span>fitted<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb72-2"><a href="quasi_likelihood.html#cb72-2" tabindex="-1"></a>hosp.disp</span></code></pre></div>
<pre><code>## [1] 0.2690233</code></pre>
<p>Dispersion estimate (Deviance):</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="quasi_likelihood.html#cb74-1" tabindex="-1"></a>hosp.glm<span class="sc">$</span>deviance<span class="sc">/</span>hosp.glm<span class="sc">$</span>df.residual</span></code></pre></div>
<pre><code>## [1] 0.2629518</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="quasi_likelihood.html#cb76-1" tabindex="-1"></a><span class="fu">summary</span>(hosp.glm)<span class="sc">$</span>cov.unscaled  <span class="co"># F^(-1) under phi=1</span></span></code></pre></div>
<pre><code>##              (Intercept)           age         temp1
## (Intercept) 1026.8932335 -0.1386065114 -10.387121099
## age           -0.1386065  0.0001206901   0.001359292
## temp1        -10.3871211  0.0013592917   0.105088741</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="quasi_likelihood.html#cb78-1" tabindex="-1"></a><span class="fu">sqrt</span>(hosp.disp)<span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">summary</span>(hosp.glm)<span class="sc">$</span>cov.unscaled)) </span></code></pre></div>
<pre><code>## (Intercept)         age       temp1 
## 16.62101763  0.00569811  0.16814078</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="quasi_likelihood.html#cb80-1" tabindex="-1"></a><span class="fu">summary</span>(hosp.glm)<span class="sc">$</span>coef[,<span class="st">&quot;Std. Error&quot;</span>]</span></code></pre></div>
<pre><code>## (Intercept)         age       temp1 
## 16.62101763  0.00569811  0.16814078</code></pre>
</div>
</div>
<div id="overdispersion" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Overdispersion<a href="quasi_likelihood.html#overdispersion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall, for the Poisson model, one has <span class="math inline">\(\phi=1\)</span>, i.e.</p>
<p><span class="math display">\[
\mbox{Var}(y_i|\theta_i)=1 \times \mathcal{V}(\mu_i)=\mathcal{V}(\mu_i)=\mu_i=E(y_i|\theta_i)
\]</span>
i.e.</p>
<p><span class="math display">\[
\frac{\mbox{Var}(y_i|\theta_i)}{E(y_i|\theta_i)}=1,
\]</span>
a property referred to as “equidispersion”.</p>
<div id="example-5.2-us-polio-data" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Example 5.2 (US Polio data)<a href="quasi_likelihood.html#example-5.2-us-polio-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="quasi_likelihood.html#cb82-1" tabindex="-1"></a><span class="fu">require</span>(gamlss.data)</span>
<span id="cb82-2"><a href="quasi_likelihood.html#cb82-2" tabindex="-1"></a><span class="fu">data</span>(polio)</span>
<span id="cb82-3"><a href="quasi_likelihood.html#cb82-3" tabindex="-1"></a>uspolio <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>( <span class="fu">matrix</span>( <span class="fu">c</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">168</span>, <span class="fu">t</span>( polio ) ), <span class="at">ncol =</span> <span class="dv">2</span> ) )</span>
<span id="cb82-4"><a href="quasi_likelihood.html#cb82-4" tabindex="-1"></a><span class="fu">colnames</span>( uspolio ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cases&quot;</span>)</span>
<span id="cb82-5"><a href="quasi_likelihood.html#cb82-5" tabindex="-1"></a><span class="fu">plot</span>( uspolio, <span class="at">type =</span> <span class="st">&quot;h&quot;</span> )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Simple linear model:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="quasi_likelihood.html#cb83-1" tabindex="-1"></a>polio.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>( cases <span class="sc">~</span> time, <span class="at">family =</span> <span class="fu">poisson</span>( <span class="at">link =</span> log ), <span class="at">data =</span> uspolio )</span>
<span id="cb83-2"><a href="quasi_likelihood.html#cb83-2" tabindex="-1"></a><span class="fu">summary</span>( polio.glm )</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time, family = poisson(link = log), data = uspolio)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.626639   0.123641   5.068 4.02e-07 ***
## time        -0.004263   0.001395  -3.055  0.00225 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 333.55  on 166  degrees of freedom
## AIC: 594.59
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Look at the summary; we see <span class="math inline">\(\phi=1\)</span>. But let’s get a quick dispersion estimate:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="quasi_likelihood.html#cb85-1" tabindex="-1"></a>polio.disp <span class="ot">&lt;-</span> <span class="fl">333.55</span><span class="sc">/</span><span class="dv">166</span></span>
<span id="cb85-2"><a href="quasi_likelihood.html#cb85-2" tabindex="-1"></a>polio.disp</span></code></pre></div>
<pre><code>## [1] 2.009337</code></pre>
<p>Now with seasonal model (annual and semi-annual cycles):</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="quasi_likelihood.html#cb87-1" tabindex="-1"></a>polio2.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases<span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb87-2"><a href="quasi_likelihood.html#cb87-2" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)), <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log),</span>
<span id="cb87-3"><a href="quasi_likelihood.html#cb87-3" tabindex="-1"></a><span class="at">data=</span>uspolio)</span>
<span id="cb87-4"><a href="quasi_likelihood.html#cb87-4" tabindex="-1"></a><span class="fu">summary</span>(polio2.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)) + I(cos(2 * pi * time/6)) + I(sin(2 * pi * 
##     time/6)), family = poisson(link = log), data = uspolio)
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               0.557241   0.127303   4.377 1.20e-05 ***
## time                     -0.004799   0.001403  -3.421 0.000625 ***
## I(cos(2 * pi * time/12))  0.137132   0.089479   1.533 0.125384    
## I(sin(2 * pi * time/12)) -0.534985   0.115476  -4.633 3.61e-06 ***
## I(cos(2 * pi * time/6))   0.458797   0.101467   4.522 6.14e-06 ***
## I(sin(2 * pi * time/6))  -0.069627   0.098123  -0.710 0.477957    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 288.85  on 162  degrees of freedom
## AIC: 557.9
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="quasi_likelihood.html#cb89-1" tabindex="-1"></a>polio2.disp<span class="ot">&lt;-</span> <span class="fl">288.65</span><span class="sc">/</span><span class="dv">162</span></span>
<span id="cb89-2"><a href="quasi_likelihood.html#cb89-2" tabindex="-1"></a>polio2.disp</span></code></pre></div>
<pre><code>## [1] 1.78179</code></pre>
<p>We see that the dispersion reduces when improving the fit of the model, but it is unlikely to `disappear’ fully.</p>
<hr />
<p>In the exammple above there is <strong>overdispersion</strong>, i.e. more dispersion in the data than supported
by the assumption <span class="math inline">\(\phi=1\)</span>.</p>
<p>Overdispersion can arise for all one-parameter exponential family distributions (Poisson, Bernoulli/Binomial,…).</p>
<p>Possible reasons for overdispersion can include:</p>
<ul>
<li>Model misspecification (such as omitted covariates)</li>
<li>latent clusters/subpopulations in the data (“unobserved heterogeneity”)</li>
</ul>
<p>What is the impact of overdispersion?</p>
<ul>
<li>There is no impact on <span class="math inline">\(\hat{\beta}\)</span>.</li>
<li>The standard error, <span class="math inline">\(SE(\hat{\beta}_j)\)</span>, when estimated using <span class="math inline">\(\phi=1\)</span>,
is underestimated by the factor <span class="math inline">\(\sqrt{\phi}\)</span> (with <span class="math inline">\(\phi\)</span> denoting the “true” <span class="math inline">\(\phi\)</span>.).</li>
</ul>
<p>As a consequence,</p>
<ul>
<li>confidence intervals will be too small;</li>
<li>p-values will be too small;</li>
<li>hence, significances overstated and potentially wrong decisions.</li>
</ul>
<p>Fortunately, there is a simple remedy to this problem:</p>
<ul>
<li>Fit a Poisson or Bernoulli/Binomial model as usual</li>
<li>Estimate <span class="math inline">\(\phi\)</span> as discussed above, yielding <span class="math inline">\(\hat{\phi}\)</span>.</li>
<li>Multiply all standard errors by <span class="math inline">\(\sqrt{\hat{\phi}}\)</span>.</li>
</ul>
<p>De facto, this amounts to the model</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i = h(\boldsymbol{x}_i^T\boldsymbol{\beta})\\
\mbox{Var}(y_i)= \phi\mathcal{V}(\mu_i)
\end{aligned}
\]</span></p>
<p>with “quasi-score function” (of which clearly <span class="math inline">\(\phi\)</span> cancels out)</p>
<p><span class="math display">\[
S(\boldsymbol{\beta})= \sum_{i=1}^n m_i \boldsymbol{x}_i \frac{y_i-\mu_i}{\phi\mathcal{V}(\mu_i)}h^{\prime}(\boldsymbol{x}_i^T\boldsymbol{\beta})\stackrel{!}{=}0
\]</span></p>
<p>and variance estimate</p>
<p><span class="math display">\[
\hat{\text{Var}}(\hat{\boldsymbol{\beta}}) = \hat{\phi}F^{-1}(\hat{\boldsymbol{\beta}})
\]</span>
Note that doing all this requires no actual distributional assumption (and there
could also not be any: The `Poisson’-type EDF with <span class="math inline">\(\phi&gt;1\)</span> is <em>not</em> a valid pdf!)</p>
<p>Estimation methods using quasi-score functions are also referred to as <strong>quasi-likelihood methods</strong>.
<!--The most popular representative is the estimation of one-parameter exponential dispersion family models where $\phi$ is not fixed but allowed to vary.--></p>
</div>
<div id="example-5.3-us-polio-data" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Example 5.3 (US Polio data)<a href="quasi_likelihood.html#example-5.3-us-polio-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us firstly produce the Pearson-type dispersion estimates.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="quasi_likelihood.html#cb91-1" tabindex="-1"></a>polio.phi <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">/</span>(polio.glm<span class="sc">$</span>df.res)<span class="sc">*</span><span class="fu">sum</span>( (uspolio<span class="sc">$</span>cases<span class="sc">-</span>polio.glm<span class="sc">$</span>fitted)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(polio.glm<span class="sc">$</span>fitted))</span>
<span id="cb91-2"><a href="quasi_likelihood.html#cb91-2" tabindex="-1"></a>polio.phi</span></code></pre></div>
<pre><code>## [1] 2.481818</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="quasi_likelihood.html#cb93-1" tabindex="-1"></a>polio2.phi <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">/</span>(polio2.glm<span class="sc">$</span>df.res)<span class="sc">*</span><span class="fu">sum</span>( (uspolio<span class="sc">$</span>cases<span class="sc">-</span>polio2.glm<span class="sc">$</span>fitted)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(polio2.glm<span class="sc">$</span>fitted))</span>
<span id="cb93-2"><a href="quasi_likelihood.html#cb93-2" tabindex="-1"></a>polio2.phi</span></code></pre></div>
<pre><code>## [1] 1.967417</code></pre>
<p>Then adjust the standard errors:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="quasi_likelihood.html#cb95-1" tabindex="-1"></a>polio.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(polio.phi)<span class="sc">*</span><span class="fu">summary</span>(polio.glm)<span class="sc">$</span>coef[,<span class="dv">2</span>]</span>
<span id="cb95-2"><a href="quasi_likelihood.html#cb95-2" tabindex="-1"></a>polio.se</span></code></pre></div>
<pre><code>## (Intercept)        time 
## 0.194781773 0.002198181</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="quasi_likelihood.html#cb97-1" tabindex="-1"></a>polio2.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(polio2.phi)<span class="sc">*</span><span class="fu">summary</span>(polio2.glm)<span class="sc">$</span>coef[,<span class="dv">2</span>]</span>
<span id="cb97-2"><a href="quasi_likelihood.html#cb97-2" tabindex="-1"></a>polio2.se </span></code></pre></div>
<pre><code>##              (Intercept)                     time I(cos(2 * pi * time/12)) 
##              0.178560577              0.001967754              0.125507133 
## I(sin(2 * pi * time/12))  I(cos(2 * pi * time/6))  I(sin(2 * pi * time/6)) 
##              0.161971821              0.142321901              0.137631208</code></pre>
<p>These results can be obtained in R directly through the use of the <code>quasipoisson</code> (or, similarly, <code>quasibinomial</code>) commands:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="quasi_likelihood.html#cb99-1" tabindex="-1"></a>polio.qglm<span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> time, <span class="at">family=</span><span class="fu">quasipoisson</span>(<span class="at">link=</span>log), <span class="at">data=</span>uspolio)</span>
<span id="cb99-2"><a href="quasi_likelihood.html#cb99-2" tabindex="-1"></a></span>
<span id="cb99-3"><a href="quasi_likelihood.html#cb99-3" tabindex="-1"></a><span class="fu">summary</span>(polio.qglm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time, family = quasipoisson(link = log), 
##     data = uspolio)
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  0.626639   0.194788   3.217  0.00156 **
## time        -0.004263   0.002198  -1.939  0.05415 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 2.481976)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 333.55  on 166  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="quasi_likelihood.html#cb101-1" tabindex="-1"></a>polio2.qglm<span class="ot">&lt;-</span> <span class="fu">glm</span>(cases<span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb101-2"><a href="quasi_likelihood.html#cb101-2" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)), <span class="at">family=</span><span class="fu">quasipoisson</span>(<span class="at">link=</span>log),</span>
<span id="cb101-3"><a href="quasi_likelihood.html#cb101-3" tabindex="-1"></a><span class="at">data=</span>uspolio)</span>
<span id="cb101-4"><a href="quasi_likelihood.html#cb101-4" tabindex="-1"></a></span>
<span id="cb101-5"><a href="quasi_likelihood.html#cb101-5" tabindex="-1"></a><span class="fu">summary</span>(polio2.qglm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)) + I(cos(2 * pi * time/6)) + I(sin(2 * pi * 
##     time/6)), family = quasipoisson(link = log), data = uspolio)
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)               0.557241   0.178566   3.121  0.00214 **
## time                     -0.004799   0.001968  -2.439  0.01583 * 
## I(cos(2 * pi * time/12))  0.137132   0.125511   1.093  0.27620   
## I(sin(2 * pi * time/12)) -0.534985   0.161977  -3.303  0.00118 **
## I(cos(2 * pi * time/6))   0.458797   0.142326   3.224  0.00153 **
## I(sin(2 * pi * time/6))  -0.069627   0.137635  -0.506  0.61363   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.96754)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 288.85  on 162  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>One can test for the presence of overdispersion by comparing <span class="math inline">\(\hat{\phi}\)</span> to
<span class="math inline">\(\chi^2_{n-p,\alpha}/(n-p)\)</span>. For instance, for the two models under consideration, the critical values for <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\phi=0\)</span> at the <span class="math inline">\(5\%\)</span> level of significance would be</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="quasi_likelihood.html#cb103-1" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.95</span>,polio.glm<span class="sc">$</span>df.res)<span class="sc">/</span>polio.glm<span class="sc">$</span>df.res</span></code></pre></div>
<pre><code>## [1] 1.187132</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="quasi_likelihood.html#cb105-1" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.95</span>,polio2.glm<span class="sc">$</span>df.res)<span class="sc">/</span>polio2.glm<span class="sc">$</span>df.res</span></code></pre></div>
<pre><code>## [1] 1.189507</code></pre>
<p>so that <span class="math inline">\(H_0\)</span> would be rejected in both cases.</p>
</div>
</div>
<div id="generalized-estimating-equations" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Generalized estimating equations<a href="quasi_likelihood.html#generalized-estimating-equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Quasi-likelihood techniques discussed in the previous subsection
motivate a more general concept. Therefore, rewrite</p>
<p><span class="math display">\[
S(\boldsymbol{\beta})= \sum_{i=1}^n \boldsymbol{x}_i\frac{y_i-\mu_i}{\phi_i \mathcal{V}(\mu_i)}h^{\prime}(\eta_i)= \boldsymbol{X}^T\boldsymbol{D}\boldsymbol{\Sigma}^{-1}(\boldsymbol{Y}-\boldsymbol{\mu})
\]</span></p>
<p>which is known from (8.61) and where as usual <span class="math inline">\(\phi_i=\phi/m_i\)</span>, <span class="math inline">\(\eta_i=\boldsymbol{x}_i^T\boldsymbol{\beta}\)</span>, <span class="math inline">\(\boldsymbol{D}=\mbox{diag}(h^{\prime}(\eta_i))\)</span>, and
<span class="math inline">\(\boldsymbol{\Sigma}= \mbox{diag}(\mbox{var}(y_i))= \mbox{diag}(\phi_i \mathcal{V}(\mu_i))\)</span>.</p>
<p>The idea is now to replace the matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span> (the shape of which was originally motivated directly by GLM properties) by <em>any</em>
appropriate ``working covariance’’ matrix <span class="math inline">\(\boldsymbol{\Sigma}= \mbox{var}(\boldsymbol{Y})\)</span>, in this manner trying to capture any correlation structures in the data as correctly as possible. From here we would compute (just as for GLMs)</p>
<p><span class="math display">\[
F(\boldsymbol{\beta})= \boldsymbol{X}^T\boldsymbol{D}^T\boldsymbol{\Sigma}^{-1}\boldsymbol{D}\boldsymbol{X}
\]</span>
allowing us to estimate the variance of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> as</p>
<p><span class="math display">\[
\mbox{var}(\hat{\boldsymbol{\beta}}) \approx F^{-1}(\hat{\boldsymbol{\beta}}).
\]</span>
Important theoretical result: Under some regularity conditions, the estimator <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is consistent and asymptotically normal even if <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is wrong!</p>
<div id="example-5.4" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Example 5.4<a href="quasi_likelihood.html#example-5.4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We first use GEEs to provide an equivalent estimate of the quasipoisson appraoch.
<!--Note that this is "first time right".--></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="quasi_likelihood.html#cb107-1" tabindex="-1"></a><span class="fu">require</span>(gee)</span></code></pre></div>
<pre><code>## Loading required package: gee</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="quasi_likelihood.html#cb109-1" tabindex="-1"></a>uspolio.gee <span class="ot">&lt;-</span> <span class="fu">gee</span>(cases<span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb109-2"><a href="quasi_likelihood.html#cb109-2" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)), <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log),<span class="at">id=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">168</span>),</span>
<span id="cb109-3"><a href="quasi_likelihood.html#cb109-3" tabindex="-1"></a> <span class="at">corstr =</span> <span class="st">&quot;independence&quot;</span>, <span class="at">data=</span>uspolio)</span></code></pre></div>
<pre><code>## Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>## running glm to get initial regression estimate</code></pre>
<pre><code>##              (Intercept)                     time I(cos(2 * pi * time/12)) 
##              0.557240558             -0.004798661              0.137131634 
## I(sin(2 * pi * time/12))  I(cos(2 * pi * time/6))  I(sin(2 * pi * time/6)) 
##             -0.534985461              0.458797164             -0.069627044</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="quasi_likelihood.html#cb113-1" tabindex="-1"></a>uspolio.gee</span></code></pre></div>
<pre><code>## 
##  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
##  gee S-function, version 4.13 modified 98/01/27 (1998) 
## 
## Model:
##  Link:                      Logarithm 
##  Variance to Mean Relation: Poisson 
##  Correlation Structure:     Independent 
## 
## Call:
## gee(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)) + I(cos(2 * pi * time/6)) + I(sin(2 * pi * 
##     time/6)), id = rep(1, 168), data = uspolio, family = poisson(link = log), 
##     corstr = &quot;independence&quot;)
## 
## Number of observations :  168 
## 
## Maximum cluster size   :  168 
## 
## 
## Coefficients:
##              (Intercept)                     time I(cos(2 * pi * time/12)) 
##              0.557240556             -0.004798661              0.137131637 
## I(sin(2 * pi * time/12))  I(cos(2 * pi * time/6))  I(sin(2 * pi * time/6)) 
##             -0.534985464              0.458797164             -0.069627041 
## 
## Estimated Scale Parameter:  1.967417
## Number of Iterations:  1
## 
## Working Correlation[1:4,1:4]
##      [,1] [,2] [,3] [,4]
## [1,]    1    0    0    0
## [2,]    0    1    0    0
## [3,]    0    0    1    0
## [4,]    0    0    0    1
## 
## 
## Returned Error Value:
## [1] 0</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="quasi_likelihood.html#cb115-1" tabindex="-1"></a><span class="fu">summary</span>(uspolio.gee)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##                              Estimate Naive S.E.    Naive z  Robust S.E.
## (Intercept)               0.557240556  0.1785640  3.1206774 1.950799e-16
## time                     -0.004798661  0.0019678 -2.4385923 2.214098e-18
## I(cos(2 * pi * time/12))  0.137131637  0.1255114  1.0925831 6.458247e-17
## I(sin(2 * pi * time/12)) -0.534985464  0.1619769 -3.3028513 5.215875e-16
## I(cos(2 * pi * time/6))   0.458797164  0.1423255  3.2235766 4.591807e-16
## I(sin(2 * pi * time/6))  -0.069627041  0.1376347 -0.5058827 1.095963e-17
##                               Robust z
## (Intercept)               2.856473e+15
## time                     -2.167321e+15
## I(cos(2 * pi * time/12))  2.123357e+15
## I(sin(2 * pi * time/12)) -1.025687e+15
## I(cos(2 * pi * time/6))   9.991647e+14
## I(sin(2 * pi * time/6))  -6.353046e+15</code></pre>
<p>But then, there is very likely serial correlation! So</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="quasi_likelihood.html#cb117-1" tabindex="-1"></a><span class="co"># uspolio.gee2 &lt;- gee(cases~time + I(cos(2*pi*time/12)) + I(sin(2*pi*time/12)) </span></span>
<span id="cb117-2"><a href="quasi_likelihood.html#cb117-2" tabindex="-1"></a><span class="co"># + I(cos(2*pi*time/6)) + I(sin(2*pi*time/6)), family=poisson(link=log), </span></span>
<span id="cb117-3"><a href="quasi_likelihood.html#cb117-3" tabindex="-1"></a><span class="co"># id=rep(1,168), data=uspolio, corstr=&quot;AR-M&quot;, Mv=1)</span></span></code></pre></div>
<p>Does not fit! We can try another package….</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="quasi_likelihood.html#cb118-1" tabindex="-1"></a><span class="fu">require</span>(geepack)</span></code></pre></div>
<pre><code>## Loading required package: geepack</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="quasi_likelihood.html#cb120-1" tabindex="-1"></a>uspolio.gee3 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( cases<span class="sc">~</span>time<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))<span class="sc">+</span><span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) </span>
<span id="cb120-2"><a href="quasi_likelihood.html#cb120-2" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>))<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)), <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log),  </span>
<span id="cb120-3"><a href="quasi_likelihood.html#cb120-3" tabindex="-1"></a><span class="at">id=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">168</span>), <span class="at">corstr=</span><span class="st">&quot;ar1&quot;</span>, <span class="at">data=</span>uspolio)</span>
<span id="cb120-4"><a href="quasi_likelihood.html#cb120-4" tabindex="-1"></a>uspolio.gee3</span></code></pre></div>
<pre><code>## 
## Call:
## geeglm(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)) + I(cos(2 * pi * time/6)) + I(sin(2 * pi * 
##     time/6)), family = poisson(link = log), data = uspolio, id = rep(1, 
##     168), corstr = &quot;ar1&quot;)
## 
## Coefficients:
##              (Intercept)                     time I(cos(2 * pi * time/12)) 
##              0.533915758             -0.004450645              0.143705437 
## I(sin(2 * pi * time/12))  I(cos(2 * pi * time/6))  I(sin(2 * pi * time/6)) 
##             -0.529102025              0.455450494             -0.065291103 
## 
## Degrees of Freedom: 168 Total (i.e. Null);  162 Residual
## 
## Scale Link:                   identity
## Estimated Scale Parameters:  [1] 1.892594
## 
## Correlation:  Structure = ar1    Link = identity 
## Estimated Correlation Parameters:
##     alpha 
## 0.2790038 
## 
## Number of clusters:   1   Maximum cluster size: 168</code></pre>
<p>… or better simplify the model. For instance, let us assume we have an AR(1) correlation structure within each year, but different years are independent:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="quasi_likelihood.html#cb122-1" tabindex="-1"></a><span class="fu">require</span>(gee)</span>
<span id="cb122-2"><a href="quasi_likelihood.html#cb122-2" tabindex="-1"></a>id<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,<span class="at">each=</span><span class="dv">12</span>)</span>
<span id="cb122-3"><a href="quasi_likelihood.html#cb122-3" tabindex="-1"></a>id</span></code></pre></div>
<pre><code>##   [1]  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2  2  3
##  [26]  3  3  3  3  3  3  3  3  3  3  3  4  4  4  4  4  4  4  4  4  4  4  4  5  5
##  [51]  5  5  5  5  5  5  5  5  5  5  6  6  6  6  6  6  6  6  6  6  6  6  7  7  7
##  [76]  7  7  7  7  7  7  7  7  7  8  8  8  8  8  8  8  8  8  8  8  8  9  9  9  9
## [101]  9  9  9  9  9  9  9  9 10 10 10 10 10 10 10 10 10 10 10 10 11 11 11 11 11
## [126] 11 11 11 11 11 11 11 12 12 12 12 12 12 12 12 12 12 12 12 13 13 13 13 13 13
## [151] 13 13 13 13 13 13 14 14 14 14 14 14 14 14 14 14 14 14</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="quasi_likelihood.html#cb124-1" tabindex="-1"></a>uspolio.gee4 <span class="ot">&lt;-</span> <span class="fu">gee</span>(cases<span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb124-2"><a href="quasi_likelihood.html#cb124-2" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)), <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log), <span class="at">id=</span>id, </span>
<span id="cb124-3"><a href="quasi_likelihood.html#cb124-3" tabindex="-1"></a> <span class="at">data=</span>uspolio, <span class="at">corstr=</span><span class="st">&quot;AR-M&quot;</span>, <span class="at">Mv=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>## running glm to get initial regression estimate</code></pre>
<pre><code>##              (Intercept)                     time I(cos(2 * pi * time/12)) 
##              0.557240558             -0.004798661              0.137131634 
## I(sin(2 * pi * time/12))  I(cos(2 * pi * time/6))  I(sin(2 * pi * time/6)) 
##             -0.534985461              0.458797164             -0.069627044</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="quasi_likelihood.html#cb128-1" tabindex="-1"></a>uspolio.gee4</span></code></pre></div>
<pre><code>## 
##  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
##  gee S-function, version 4.13 modified 98/01/27 (1998) 
## 
## Model:
##  Link:                      Logarithm 
##  Variance to Mean Relation: Poisson 
##  Correlation Structure:     AR-M , M = 1 
## 
## Call:
## gee(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)) + I(cos(2 * pi * time/6)) + I(sin(2 * pi * 
##     time/6)), id = id, data = uspolio, family = poisson(link = log), 
##     corstr = &quot;AR-M&quot;, Mv = 1)
## 
## Number of observations :  168 
## 
## Maximum cluster size   :  12 
## 
## 
## Coefficients:
##              (Intercept)                     time I(cos(2 * pi * time/12)) 
##              0.534670137             -0.004504214              0.127605025 
## I(sin(2 * pi * time/12))  I(cos(2 * pi * time/6))  I(sin(2 * pi * time/6)) 
##             -0.518732586              0.434976179             -0.059598999 
## 
## Estimated Scale Parameter:  1.983319
## Number of Iterations:  3
## 
## Working Correlation[1:4,1:4]
##            [,1]       [,2]       [,3]       [,4]
## [1,] 1.00000000 0.26087713 0.06805688 0.01775448
## [2,] 0.26087713 1.00000000 0.26087713 0.06805688
## [3,] 0.06805688 0.26087713 1.00000000 0.26087713
## [4,] 0.01775448 0.06805688 0.26087713 1.00000000
## 
## 
## Returned Error Value:
## [1] 0</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="quasi_likelihood.html#cb130-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(uspolio.gee4)<span class="sc">$</span>working.correlation, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##        [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
##  [1,] 1.000 0.261 0.068 0.018 0.005 0.001 0.000 0.000 0.000 0.000 0.000 0.000
##  [2,] 0.261 1.000 0.261 0.068 0.018 0.005 0.001 0.000 0.000 0.000 0.000 0.000
##  [3,] 0.068 0.261 1.000 0.261 0.068 0.018 0.005 0.001 0.000 0.000 0.000 0.000
##  [4,] 0.018 0.068 0.261 1.000 0.261 0.068 0.018 0.005 0.001 0.000 0.000 0.000
##  [5,] 0.005 0.018 0.068 0.261 1.000 0.261 0.068 0.018 0.005 0.001 0.000 0.000
##  [6,] 0.001 0.005 0.018 0.068 0.261 1.000 0.261 0.068 0.018 0.005 0.001 0.000
##  [7,] 0.000 0.001 0.005 0.018 0.068 0.261 1.000 0.261 0.068 0.018 0.005 0.001
##  [8,] 0.000 0.000 0.001 0.005 0.018 0.068 0.261 1.000 0.261 0.068 0.018 0.005
##  [9,] 0.000 0.000 0.000 0.001 0.005 0.018 0.068 0.261 1.000 0.261 0.068 0.018
## [10,] 0.000 0.000 0.000 0.000 0.001 0.005 0.018 0.068 0.261 1.000 0.261 0.068
## [11,] 0.000 0.000 0.000 0.000 0.000 0.001 0.005 0.018 0.068 0.261 1.000 0.261
## [12,] 0.000 0.000 0.000 0.000 0.000 0.000 0.001 0.005 0.018 0.068 0.261 1.000</code></pre>
<p>This last assumption on the correlation structure of the data leads us to <em>repeated measures data</em>, which is the actual strength of GEEs.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="deviance_and_diagnostics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="marginal_models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Quasi_likelihood.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
