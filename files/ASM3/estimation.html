<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Estimation | Advanced Statistical Modelling III (second term)</title>
  <meta name="description" content="These are the course notes for the module Advanced Statistical Modelling III of Durham University’s degree for Mathematics and Statistics." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Estimation | Advanced Statistical Modelling III (second term)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These are the course notes for the module Advanced Statistical Modelling III of Durham University’s degree for Mathematics and Statistics." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Estimation | Advanced Statistical Modelling III (second term)" />
  
  <meta name="twitter:description" content="These are the course notes for the module Advanced Statistical Modelling III of Durham University’s degree for Mathematics and Statistics." />
  

<meta name="author" content="Dr. Cuong Nguyen" />


<meta name="date" content="2024-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generalised_linear_models.html"/>
<link rel="next" href="prediction_and_inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Statistical Modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Module Information</a></li>
<li class="chapter" data-level="1" data-path="generalised_linear_models.html"><a href="generalised_linear_models.html"><i class="fa fa-check"></i><b>1</b> Review of Generalised Linear Models</a></li>
<li class="chapter" data-level="2" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estimation.html"><a href="estimation.html#likelihood"><i class="fa fa-check"></i><b>2.1</b> Likelihood</a></li>
<li class="chapter" data-level="2.2" data-path="estimation.html"><a href="estimation.html#loglike"><i class="fa fa-check"></i><b>2.2</b> Log-Likelihood</a></li>
<li class="chapter" data-level="2.3" data-path="estimation.html"><a href="estimation.html#score-function-and-equation"><i class="fa fa-check"></i><b>2.3</b> Score Function and Equation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="estimation.html"><a href="estimation.html#natural-link"><i class="fa fa-check"></i><b>2.3.1</b> Natural Link</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="estimation.html"><a href="estimation.html#fisherinformation"><i class="fa fa-check"></i><b>2.4</b> Fisher Information</a></li>
<li class="chapter" data-level="2.5" data-path="estimation.html"><a href="estimation.html#example-poisson-regression"><i class="fa fa-check"></i><b>2.5</b> Example: Poisson Regression</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="estimation.html"><a href="estimation.html#with-natural-link"><i class="fa fa-check"></i><b>2.5.1</b> With Natural Link</a></li>
<li class="chapter" data-level="2.5.2" data-path="estimation.html"><a href="estimation.html#with-identity-link"><i class="fa fa-check"></i><b>2.5.2</b> With Identity Link</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="estimation.html"><a href="estimation.html#properties-of-boldsymbolsboldsymbolbeta-and-boldsymbolfboldsymbolbeta"><i class="fa fa-check"></i><b>2.6</b> Properties of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span> and <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span></a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="estimation.html"><a href="estimation.html#expectation-of-boldsymbolsboldsymbolbeta"><i class="fa fa-check"></i><b>2.6.1</b> Expectation of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span></a></li>
<li class="chapter" data-level="2.6.2" data-path="estimation.html"><a href="estimation.html#variance-of-boldsymbolsboldsymbolbeta"><i class="fa fa-check"></i><b>2.6.2</b> Variance of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span></a></li>
<li class="chapter" data-level="2.6.3" data-path="estimation.html"><a href="estimation.html#boldsymbolfboldsymbolbeta"><i class="fa fa-check"></i><b>2.6.3</b> <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="estimation.html"><a href="estimation.html#matrix-notation"><i class="fa fa-check"></i><b>2.7</b> Matrix Notation</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="estimation.html"><a href="estimation.html#score-function-and-fisher-information"><i class="fa fa-check"></i><b>2.7.1</b> Score Function and Fisher Information</a></li>
<li class="chapter" data-level="2.7.2" data-path="estimation.html"><a href="estimation.html#natural-link-2"><i class="fa fa-check"></i><b>2.7.2</b> Natural Link</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="estimation.html"><a href="estimation.html#iterativesolution"><i class="fa fa-check"></i><b>2.8</b> Iterative Solution of <span class="math inline">\(\boldsymbol{S}(\hat{\boldsymbol{\beta}}) = 0\)</span></a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="estimation.html"><a href="estimation.html#irls-pseudo-code"><i class="fa fa-check"></i><b>2.8.1</b> IRLS Pseudo-Code</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="estimation.html"><a href="estimation.html#practical-example-dataset-b-us-polio-data"><i class="fa fa-check"></i><b>2.9</b> Practical Example: Dataset B: US Polio Data</a></li>
<li class="chapter" data-level="2.10" data-path="estimation.html"><a href="estimation.html#estimation-of-phi"><i class="fa fa-check"></i><b>2.10</b> Estimation of <span class="math inline">\(\phi\)</span></a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="estimation.html"><a href="estimation.html#special-cases"><i class="fa fa-check"></i><b>2.10.1</b> Special Cases</a></li>
<li class="chapter" data-level="2.10.2" data-path="estimation.html"><a href="estimation.html#practical-example-dataset-c-hospital-data"><i class="fa fa-check"></i><b>2.10.2</b> Practical Example: Dataset C: Hospital Data</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="estimation.html"><a href="estimation.html#asymptotic-properties-of-hatboldsymbolbeta"><i class="fa fa-check"></i><b>2.11</b> Asymptotic Properties of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="estimation.html"><a href="estimation.html#fisher-scoring"><i class="fa fa-check"></i><b>2.11.1</b> Fisher Scoring</a></li>
<li class="chapter" data-level="2.11.2" data-path="estimation.html"><a href="estimation.html#expectation"><i class="fa fa-check"></i><b>2.11.2</b> Expectation</a></li>
<li class="chapter" data-level="2.11.3" data-path="estimation.html"><a href="estimation.html#variance"><i class="fa fa-check"></i><b>2.11.3</b> Variance</a></li>
<li class="chapter" data-level="2.11.4" data-path="estimation.html"><a href="estimation.html#asymptotic-normality"><i class="fa fa-check"></i><b>2.11.4</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="2.11.5" data-path="estimation.html"><a href="estimation.html#closing-the-circle"><i class="fa fa-check"></i><b>2.11.5</b> Closing The Circle</a></li>
<li class="chapter" data-level="2.11.6" data-path="estimation.html"><a href="estimation.html#next-step"><i class="fa fa-check"></i><b>2.11.6</b> Next Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html"><i class="fa fa-check"></i><b>3</b> Prediction and Inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#prediction2"><i class="fa fa-check"></i><b>3.1</b> Prediction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#example-dataset-b"><i class="fa fa-check"></i><b>3.1.1</b> Example: Dataset B</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#hypothesis-tests"><i class="fa fa-check"></i><b>3.2</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#simple-tests"><i class="fa fa-check"></i><b>3.2.1</b> Simple Tests</a></li>
<li class="chapter" data-level="3.2.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#generalisation-to-nested-models"><i class="fa fa-check"></i><b>3.2.2</b> Generalisation to Nested Models</a></li>
<li class="chapter" data-level="3.2.3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#example-dataset-c"><i class="fa fa-check"></i><b>3.2.3</b> Example: Dataset C</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#confidence-regions-for-hatboldsymbolbeta"><i class="fa fa-check"></i><b>3.3</b> Confidence Regions for <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#alpha-hessian-cr"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\((1 - \alpha)\)</span> Hessian CR</a></li>
<li class="chapter" data-level="3.3.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#alpha-method-of-support-cr"><i class="fa fa-check"></i><b>3.3.2</b> <span class="math inline">\((1 - \alpha)\)</span> <em>method of support</em> CR</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#issues-with-glms-and-the-wald-test"><i class="fa fa-check"></i><b>3.4</b> Issues with GLMs and the Wald Test</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#separation"><i class="fa fa-check"></i><b>3.4.1</b> Separation</a></li>
<li class="chapter" data-level="3.4.2" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#hauck-donner-effect"><i class="fa fa-check"></i><b>3.4.2</b> Hauck-Donner Effect</a></li>
<li class="chapter" data-level="3.4.3" data-path="prediction_and_inference.html"><a href="prediction_and_inference.html#next-step-1"><i class="fa fa-check"></i><b>3.4.3</b> Next Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html"><i class="fa fa-check"></i><b>4</b> Deviance</a>
<ul>
<li class="chapter" data-level="4.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#goodness-of-fit"><i class="fa fa-check"></i><b>4.1</b> Goodness-of-Fit</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#saturated-model"><i class="fa fa-check"></i><b>4.1.1</b> Saturated Model</a></li>
<li class="chapter" data-level="4.1.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#deviance"><i class="fa fa-check"></i><b>4.1.2</b> Deviance</a></li>
<li class="chapter" data-level="4.1.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-special-cases"><i class="fa fa-check"></i><b>4.1.3</b> Example Special Cases</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#asymptotic-properties"><i class="fa fa-check"></i><b>4.2</b> Asymptotic Properties</a></li>
<li class="chapter" data-level="4.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#pearson-statistic"><i class="fa fa-check"></i><b>4.3</b> Pearson Statistic</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#relation-to-deviance"><i class="fa fa-check"></i><b>4.3.1</b> Relation to Deviance</a></li>
<li class="chapter" data-level="4.3.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#pearson-residuals"><i class="fa fa-check"></i><b>4.3.2</b> Pearson Residuals</a></li>
<li class="chapter" data-level="4.3.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-b-1"><i class="fa fa-check"></i><b>4.3.3</b> Example: Dataset B</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#residuals-and-diagnostics"><i class="fa fa-check"></i><b>4.4</b> Residuals and Diagnostics</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-c-1"><i class="fa fa-check"></i><b>4.4.1</b> Example: Dataset C</a></li>
<li class="chapter" data-level="4.4.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-b-2"><i class="fa fa-check"></i><b>4.4.2</b> Example: Dataset B</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#analysis-of-deviance"><i class="fa fa-check"></i><b>4.5</b> Analysis of Deviance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#interpretation-and-testing"><i class="fa fa-check"></i><b>4.5.1</b> Interpretation and Testing</a></li>
<li class="chapter" data-level="4.5.2" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#general-case"><i class="fa fa-check"></i><b>4.5.2</b> General Case</a></li>
<li class="chapter" data-level="4.5.3" data-path="deviance_and_diagnostics.html"><a href="deviance_and_diagnostics.html#example-dataset-c-2"><i class="fa fa-check"></i><b>4.5.3</b> Example: Dataset C</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html"><i class="fa fa-check"></i><b>5</b> Quasi-Likelihood methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#dispersion"><i class="fa fa-check"></i><b>5.1</b> Dispersion</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.1-hospital-stay-data"><i class="fa fa-check"></i><b>5.1.1</b> Example 5.1 (Hospital stay data)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#overdispersion"><i class="fa fa-check"></i><b>5.2</b> Overdispersion</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.2-us-polio-data"><i class="fa fa-check"></i><b>5.2.1</b> Example 5.2 (US Polio data)</a></li>
<li class="chapter" data-level="5.2.2" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.3-us-polio-data"><i class="fa fa-check"></i><b>5.2.2</b> Example 5.3 (US Polio data)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#generalized-estimating-equations"><i class="fa fa-check"></i><b>5.3</b> Generalized estimating equations</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="quasi_likelihood.html"><a href="quasi_likelihood.html#example-5.4"><i class="fa fa-check"></i><b>5.3.1</b> Example 5.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="marginal_models.html"><a href="marginal_models.html"><i class="fa fa-check"></i><b>6</b> Marginal models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="marginal_models.html"><a href="marginal_models.html#repeated-measures-data"><i class="fa fa-check"></i><b>6.1</b> Repeated measures data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="marginal_models.html"><a href="marginal_models.html#example-6.1-oxford-boys-data"><i class="fa fa-check"></i><b>6.1.1</b> Example 6.1 (Oxford boys data)</a></li>
<li class="chapter" data-level="6.1.2" data-path="marginal_models.html"><a href="marginal_models.html#example-6.2-mathematics-achievement-data"><i class="fa fa-check"></i><b>6.1.2</b> Example 6.2 (Mathematics achievement data)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="marginal_models.html"><a href="marginal_models.html#the-marginal-model-for-repeated-measures"><i class="fa fa-check"></i><b>6.2</b> The marginal model for repeated measures</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="marginal_models.html"><a href="marginal_models.html#example-6.3"><i class="fa fa-check"></i><b>6.2.1</b> Example 6.3</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="marginal_models.html"><a href="marginal_models.html#estimation-1"><i class="fa fa-check"></i><b>6.3</b> Estimation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="marginal_models.html"><a href="marginal_models.html#example-6.4"><i class="fa fa-check"></i><b>6.3.1</b> Example 6.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html"><i class="fa fa-check"></i><b>7</b> Linear mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#random-intercept-models"><i class="fa fa-check"></i><b>7.1</b> Random intercept models</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.1-oxford-boys-data"><i class="fa fa-check"></i><b>7.1.1</b> Example 7.1 (Oxford boys data)</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.2-oxford-boys-data"><i class="fa fa-check"></i><b>7.1.2</b> Example 7.2 (Oxford boys data)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#random-slope-models"><i class="fa fa-check"></i><b>7.2</b> Random slope models</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.3-oxford-boys"><i class="fa fa-check"></i><b>7.2.1</b> Example 7.3 (Oxford boys)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#the-linear-mixed-model-lmm"><i class="fa fa-check"></i><b>7.3</b> The Linear Mixed Model (LMM)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.4"><i class="fa fa-check"></i><b>7.3.1</b> Example 7.4</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#estimation-of-fixed-effects"><i class="fa fa-check"></i><b>7.4</b> Estimation of fixed effects</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.5"><i class="fa fa-check"></i><b>7.4.1</b> Example 7.5</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#inference-for-fixed-effects"><i class="fa fa-check"></i><b>7.5</b> Inference for fixed effects</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.6-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.5.1</b> Example 7.6 (Mathematics achievement data)</a></li>
<li class="chapter" data-level="7.5.2" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.7-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.5.2</b> Example 7.7 (Mathematics achievement data)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#prediction-of-random-effects"><i class="fa fa-check"></i><b>7.6</b> Prediction of random effects</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.8-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.6.1</b> Example 7.8 (Mathematics achievement data)</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#inference-for-random-effects"><i class="fa fa-check"></i><b>7.7</b> Inference for random effects</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="linear_mixed_models.html"><a href="linear_mixed_models.html#example-7.9-mathematics-achievement-data"><i class="fa fa-check"></i><b>7.7.1</b> Example 7.9 (Mathematics achievement data)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Statistical Modelling III (second term)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimation" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Estimation<a href="estimation.html#estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="likelihood" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Likelihood<a href="estimation.html#likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the grouped data setup where we have predictors and data with possible replicates <span class="math inline">\(\left\{(\boldsymbol{x}_{i}, y_{ir_{i}})\right\}_{i\in[1..n], r_{i}\in[1..m_{i}]}\)</span>.
Recall that under a GLM, given predictors <span class="math inline">\(\left\{\boldsymbol{x}_{i}\right\}_{i\in[1..n]}\)</span>, each response <span class="math inline">\(y_{ir_{i}}\)</span> is independent of the other <span class="math inline">\(y_{jr_{j}}\)</span>, and of the values of all predictors <span class="math inline">\(\boldsymbol{x}_{j}\)</span> with <span class="math inline">\(j\neq i\)</span>, so that the joint probability of the data — that is, the likelihood — is given by
<span class="math display" id="eq:jointprobability">\[\begin{equation}
        L(\boldsymbol{\beta}) = P_{}\left(\left\{y_{ir_{i}}\right\} |\left\{\boldsymbol{x}_{i}\right\}, \boldsymbol{\beta}\right)
        =
        P_{}\left(\left\{y_{ir_{i}}\right\} |\left\{\theta_{i}\right\}, \phi\right)
        = \prod_{i = 1}^{n} \prod_{r_{i} = 1}^{m_{i}}
        P_{}\left(y_{ir_{i}} |\theta_{i}, \phi\right)
        \tag{2.1}
    \end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
        P_{}\left(y_{ir_{i}} |\theta_{i}, \phi\right)
        =
        \exp
        \left(
            \frac{y_{ir_{i}}\theta_{i} - b(\theta_{i})}{ \phi} + c(y_{ir_{i}},
            \phi)
        \right)
    \end{equation}\]</span>
with
<span class="math display">\[\begin{equation}
        \theta_{i}
        = (b&#39;)^{-1}(\mu_{i})
        = (b&#39;)^{-1}(h(\eta_{i}))
        = (b&#39;)^{-1}(h(\boldsymbol{\beta}^{T}\boldsymbol{x}_{i}))
    \end{equation}\]</span></p>
</div>
<div id="loglike" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Log-Likelihood<a href="estimation.html#loglike" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The log probability of the data — or log-likelihood — is thus given by
<span class="math display">\[\begin{align}
        l(\boldsymbol{\beta})
        &amp; =
        \log P_{}\left(\left\{y_{ir_{i}}\right\} |\left\{\theta_{i}\right\}, \phi\right)
        \\
        &amp; =
        \sum_{i} \sum_{r_{i}}
        \left(
            \frac{y_{ir_{i}}\theta_{i} - b(\theta_{i})}{\phi} + c(y_{ir_{i}},
            \phi)
        \right)
        \\
        &amp; =
        \sum_{i}
        \left(
            m_{i} \frac{y_{i}\theta_{i} - b(\theta_{i})}{\phi}
            +
            \sum_{r_{i}} c(y_{ir_{i}}, \phi)
        \right)
        \\
        &amp; =
        \sum_{i} l_{i}
    \end{align}\]</span></p>
<p>where
<span class="math display">\[\begin{equation}
l_i =
             \frac{y_{i}\theta_{i} - b(\theta_{i})}{\phi_i}
            +
            \sum_{r_{i}} c(y_{ir_{i}}, \phi)
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\phi_i = \phi/m_i
\end{equation}\]</span>
and
<span class="math display">\[\begin{equation}
y_i = \frac{1}{m_i} \sum_{r_{i}} y_{ir_{i}}
\end{equation}\]</span></p>
</div>
<div id="score-function-and-equation" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Score Function and Equation<a href="estimation.html#score-function-and-equation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <span style="color: blue;">score function</span> is given by
<span class="math display" id="eq:scorefunction">\[\begin{equation}
        \boldsymbol{S}(\boldsymbol{\beta})
        =
        \frac{\partial l }{ \partial \boldsymbol{\beta}^{T}}
        =
        \sum_{i}
        \frac{\partial l_{i} }{ \partial \boldsymbol{\beta}^{T}}
        =
        \sum_{i}
        \frac{\partial l_{i} }{ \partial \theta_{i}}
        \frac{\partial \theta_{i} }{ \partial \mu_{i}}
        \frac{\partial \mu_{i} }{ \partial \eta_{i}}
        \frac{\partial \eta_{i} }{ \partial \boldsymbol{\beta}^{T}}
        \tag{2.2}
    \end{equation}\]</span>
where, recalling that <span class="math inline">\(\mu_i = b&#39;(\theta_i)\)</span>, <span class="math inline">\(\mu_i = h(\eta_i)\)</span> and <span class="math inline">\(\eta_i = \boldsymbol{\beta}^T\boldsymbol{x}_i\)</span>, we have<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:
<span class="math display" id="eq:dmudeta" id="eq:dthetadmu">\[\begin{align}
        \frac{\partial l_{i} }{ \partial \theta_{i}}
        &amp; =
        \frac{y_{i} - b&#39;(\theta_{i})}{ \phi_{i}}
        =
        \frac{y_{i} - \mu_{i}}{ \phi_{i}}
        \\
        \frac{\partial \theta_{i} }{ \partial \mu_{i}}
        &amp; =
        \frac{\partial (b&#39;)^{-1} }{ \partial \mu_{i}}
        =
        \frac{1 }{ b&#39;&#39;((b&#39;)^{-1}(\mu_{i}))}
        =
        \frac{1 }{ \mathcal{V}(\mu_{i})}
        =
        \frac{1 }{ b&#39;&#39;(\theta_{i})}
        \tag{2.3}\\
        \frac{\partial \mu_{i} }{ \partial \eta_{i}}
        &amp; =
        h&#39;(\eta_{i})
        \tag{2.4}\\
        \frac{\partial \eta_{i} }{ \partial \boldsymbol{\beta}^{T}}
        &amp; =
        \boldsymbol{x}_{i}
    \end{align}\]</span></p>
<p>The score function is thus given by
<span class="math display" id="eq:scorefunction2">\[\begin{align}
        \boldsymbol{S}(\boldsymbol{\beta})
        &amp; =
        \sum_{i}
        \left(
            \frac{y_{i} - \mu_{i}}{ \phi_{i}}
        \right)\;
        \left(
            \frac{1 }{ \mathcal{V}(\mu_{i})}
        \right)\;
        h&#39;(\eta_{i})\;\boldsymbol{x}_{i}
        \\
        &amp; =
        \frac{1}{\phi}\sum_{i} m_{i}(y_{i} - \mu_{i})\;\frac{1}{
        \mathcal{V}(\mu_{i})}\;
        h&#39;(\eta_{i})\;\boldsymbol{x}_{i}
        \tag{2.5}
    \end{align}\]</span></p>
<p>The maximum likelihood estimate <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> must then satisfy the <span style="color: blue;">score equation</span>:
<span class="math display" id="eq:scoreequation">\[\begin{equation}
        \boldsymbol{S}(\hat{\boldsymbol{\beta}}) = 0
        \tag{2.6}
    \end{equation}\]</span></p>
<p>Note that the dispersion parameter <span class="math inline">\(\phi\)</span> cancels from the score equation, which implies that <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> does not depend on <span class="math inline">\(\phi\)</span>. This is another important property of EDFs.</p>
<div id="natural-link" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Natural Link<a href="estimation.html#natural-link" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the natural link, <span class="math inline">\(\theta_{i} = \eta_{i}\)</span>, so Equations <a href="estimation.html#eq:dthetadmu">(2.3)</a> and <a href="estimation.html#eq:dmudeta">(2.4)</a> combine to give
<span class="math display">\[\begin{equation}
\frac{h&#39;(\eta_i)}{\mathcal{V}(\mu_i)} =
\frac{\partial\theta_{i}}{\partial \mu_{i}} \frac{\partial\mu_{i}}{\partial \eta_{i}} = \frac{\partial\theta_{i}}{\partial \eta_{i}} = 1
\end{equation}\]</span>
The score function thus simplifies to
<span class="math display" id="eq:scorefunctionnaturallink">\[\begin{equation}
        \boldsymbol{S}(\boldsymbol{\beta}) = \frac{1}{\phi}\sum_{i} m_{i}(y_{i} - \mu_{i})\;\boldsymbol{x}_{i}
        \tag{2.7}
    \end{equation}\]</span></p>
</div>
</div>
<div id="fisherinformation" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Fisher Information<a href="estimation.html#fisherinformation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For future developments, we will also need the second derivative of the log likelihood. Up to a <span style="color: red;">change of sign</span>, this is called the <span style="color: red;">Observed Fisher Information</span>, defined as
<span class="math display" id="eq:observedfisherinformation">\[\begin{equation}
        \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})
        =
        - \frac{\partial^{2} l }{ \partial\boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        =
        - \frac{\partial \boldsymbol{S}}{\partial \boldsymbol{\beta}}
        \tag{2.8}
    \end{equation}\]</span>
Note that, at the MLE, <span class="math inline">\(\boldsymbol{F}_{\text{obs}}(\hat{\boldsymbol{\beta}})\)</span> is positive by definition.
Because it is a function of the data <span class="math inline">\(\left\{y_{i}\right\}\)</span>, <span class="math inline">\(\boldsymbol{F}_{\text{obs}}\)</span> has a probability distribution. In practice, the Observed Fisher Information is often approximated by the <span style="color: red;">Expected Fisher Information</span><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, otherwise known simply as the <span style="color: red;">Fisher Information</span>:
<span class="math display" id="eq:fisherinformation">\[\begin{equation}
        \boldsymbol{F}(\boldsymbol{\beta})
        =
        E
        \left[
            - \frac{\partial \boldsymbol{S} }{ \partial \boldsymbol{\beta}}
        \right]
        \tag{2.9}
    \end{equation}\]</span></p>
<p>where the expectation is taken over the joint probability distribution of the data <span class="math inline">\(P_{}\left(\left\{y_{ir_{i}}\right\} |\boldsymbol{\beta}, \left\{\boldsymbol{x}_{i}\right\}\right)\)</span>.</p>
</div>
<div id="example-poisson-regression" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Example: Poisson Regression<a href="estimation.html#example-poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We look at two example calculations of the score function and Fisher Information for Poisson Regression, that is we have</p>
<ul>
<li><span class="math inline">\(y |\boldsymbol{x}, \boldsymbol{\beta} \sim \text{Poi}(\lambda(\boldsymbol{x}))\)</span></li>
<li><span class="math inline">\(\phi = 1\)</span></li>
</ul>
<div id="with-natural-link" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> With Natural Link<a href="estimation.html#with-natural-link" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have that</p>
<ul>
<li><span class="math inline">\(\lambda(\boldsymbol{x}) = \mu(\boldsymbol{x}) = h(\eta(\boldsymbol{x})) = e^{\eta(\boldsymbol{x})} = e^{\boldsymbol{\beta}^T\boldsymbol{x}}\)</span></li>
</ul>
<p>Equation <a href="estimation.html#eq:scorefunctionnaturallink">(2.7)</a> then gives:
<span class="math display">\[\begin{equation}
        \boldsymbol{S}(\boldsymbol{\beta})
        =
        \sum_{i} (y_{i} - e^{\boldsymbol{\beta}^{T}\boldsymbol{x}_{i}})\;\boldsymbol{x}_{i}
    \end{equation}\]</span>
while Equation <a href="estimation.html#eq:observedfisherinformation">(2.8)</a> gives
<span class="math display">\[\begin{equation}
        \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})
        =
        \sum_{i} e^{\boldsymbol{\beta}^{T}\boldsymbol{x}_{i}}\;\boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
    \end{equation}\]</span>
Note that this does not depend on the data, so that Equation <a href="estimation.html#eq:fisherinformation">(2.9)</a> gives
<span class="math display">\[\begin{equation}
        \boldsymbol{F}(\boldsymbol{\beta}) = {\mathrm E}[\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})] = \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})
    \end{equation}\]</span></p>
</div>
<div id="with-identity-link" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> With Identity Link<a href="estimation.html#with-identity-link" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The identity link is defined such that <span class="math inline">\(h(\eta) = \eta\)</span>.</p>
<p>In this case we have that:</p>
<ul>
<li><span class="math inline">\(\lambda(\boldsymbol{x}) = \mu(\boldsymbol{x}) = h(\eta(\boldsymbol{x})) = \eta(\boldsymbol{x}) = \boldsymbol{\beta}^T\boldsymbol{x}\)</span></li>
<li><span class="math inline">\(\mathcal{V}(\mu) = \mu\)</span> (see Poisson example in EDF chapter)</li>
<li><span class="math inline">\(h&#39;(\eta) = 1\)</span></li>
</ul>
<p>Equation <a href="estimation.html#eq:scorefunction2">(2.5)</a> gives
<span class="math display">\[\begin{align}
        \boldsymbol{S}(\boldsymbol{\beta})
        &amp; =
        \sum_{i} (y_{i} - \mu_{i})\;\frac{1}{ \mu_{i}}\;1 \;\boldsymbol{x}_{i}
        \\
        &amp; =
        \sum_{i} (y_{i} - \boldsymbol{\beta}^{T}\boldsymbol{x}_{i}) \;\frac{1}{ \boldsymbol{\beta}^{T}\boldsymbol{x}_{i}}\;
        \boldsymbol{x}_{i}
        \\
        &amp; =
        \sum_{i}
        \left(
            \frac{y_{i}}{ \boldsymbol{\beta}^{T}\boldsymbol{x}_{i}} - 1
        \right)\;
        \boldsymbol{x}_{i}
    \end{align}\]</span>
The Observed Fisher Information is given by
<span class="math display">\[\begin{equation}
        \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})
        =
        \sum_{i} \frac{y_{i}}{ (\boldsymbol{\beta}^{T}\boldsymbol{x}_{i})^{2}}\;\boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
    \end{equation}\]</span>
<!-- chain rule -->
and the Fisher Information is given by
<span class="math display">\[\begin{align}
        \boldsymbol{F}(\boldsymbol{\beta})
        &amp; = {\mathrm E}[\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})]
        \\
        &amp; =
        \textrm{E}
        \left[
            \sum_{i} \frac{Y_{i}}{(\boldsymbol{\beta}^{T}\boldsymbol{x}_{i})^{2}}\;\boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
        \right]
        \\
        &amp; =
        \sum_{i} \frac{{\mathrm E}[Y_{i} |\boldsymbol{\beta}, \boldsymbol{x}_{i}] }{ (\boldsymbol{\beta}^{T}\boldsymbol{x}_{i})^{2}}\;
        \boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
        \\
        &amp; =
        \sum_{i} \frac{\boldsymbol{\beta}^{T}\boldsymbol{x}_{i} }{ (\boldsymbol{\beta}^{T}\boldsymbol{x}_{i})^{2}}\;
        \boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
        \\
        &amp; =
        \sum_{i} \frac{1 }{ \boldsymbol{\beta}^{T}\boldsymbol{x}_{i}}\;\boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
    \end{align}\]</span></p>
<p>Note that <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta}) \neq \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})\)</span> in this case.</p>
</div>
</div>
<div id="properties-of-boldsymbolsboldsymbolbeta-and-boldsymbolfboldsymbolbeta" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Properties of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span> and <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span><a href="estimation.html#properties-of-boldsymbolsboldsymbolbeta-and-boldsymbolfboldsymbolbeta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Defining <span class="math inline">\(S_i(\boldsymbol{\beta}) = \frac{\partial l_i}{\partial \boldsymbol{\beta}}\)</span>, we have that <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta}) = \sum_{i} \boldsymbol{S}_{i}(\boldsymbol{\beta})\)</span>.</p>
<div id="expectation-of-boldsymbolsboldsymbolbeta" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Expectation of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span><a href="estimation.html#expectation-of-boldsymbolsboldsymbolbeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The expectation of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span> can be computed from Equation <a href="estimation.html#eq:scorefunction">(2.2)</a> as follows:
<span class="math display" id="eq:expectationSbeta">\[\begin{align}
        {\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})]
        &amp; =
        \sum_{i} {\mathrm E}[\boldsymbol{S}_{i}(\boldsymbol{\beta})]
        \\
        &amp; =
        \sum_{i} \frac{{\mathrm E}[Y_{i} |\boldsymbol{\beta}, \boldsymbol{x}_{i}] - \mu_{i}}{ \phi_{i}} \frac{1}{\mathcal{V}(\mu_{i})} h&#39;(\eta_{i})\;\boldsymbol{x}_i
        \\
        &amp; = 0
        \tag{2.10}
    \end{align}\]</span>
because <span class="math inline">\({\mathrm E}[Y_{i} |\boldsymbol{\beta}, \boldsymbol{x}_{i}] = \mu_{i}\)</span>.</p>
</div>
<div id="variance-of-boldsymbolsboldsymbolbeta" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Variance of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span><a href="estimation.html#variance-of-boldsymbolsboldsymbolbeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To calculate the variance of <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta})\)</span>, we proceed as follows. First, we note that
<span class="math display">\[\begin{align}
{\mathrm{Var}}[\boldsymbol{S}(\boldsymbol{\beta})] &amp; = {\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})\boldsymbol{S}(\boldsymbol{\beta})^{T}] - {\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})]{\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})^T]
\\
&amp; = {\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})\boldsymbol{S}(\boldsymbol{\beta})^{T}]
\end{align}\]</span>
because <span class="math inline">\({\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})] = 0\)</span> from Equation <a href="estimation.html#eq:expectationSbeta">(2.10)</a>.</p>
<p>We then have (dropping the argument <span class="math inline">\(\boldsymbol{\beta}\)</span>)
<span class="math display" id="eq:expectationsst">\[\begin{equation}
        {\mathrm E}[\boldsymbol{S} \boldsymbol{S}^{T}]
        =
        \mathrm{E}
        \left[
            \left(
                \sum_{i} \boldsymbol{S}_{i}
            \right)
            \left(
                \sum_{j}\boldsymbol{S}_{j}^{T}
            \right)
        \right]
        =
        \sum_{i, j}{\mathrm E}[\boldsymbol{S}_{i}\boldsymbol{S}_{j}^{T}]
        \tag{2.11}
    \end{equation}\]</span></p>
<p>with<br />
<span class="math display">\[\begin{align}
        {\mathrm E}[\boldsymbol{S}_{i}\boldsymbol{S}_{j}^{T}]
        &amp; = \mathrm{E} \left[
        \left(
        \frac{Y_{i} - \mu_{i}}{ \phi_{i}} \frac{1}{\mathcal{V}(\mu_{i})} h&#39;(\eta_{i})\;\boldsymbol{x}_i
        \right)
        \left(
        \frac{Y_{j} - \mu_{j}}{ \phi_{j}} \frac{1}{\mathcal{V}(\mu_{j})} h&#39;(\eta_{j})\;\boldsymbol{x}_j
        \right)
        \right]
         \\
        &amp; =
        \delta_{ij}\;
        \frac{\phi_{i}\mathcal{V}(\mu_{i})}{ \phi_{i}^2\mathcal{V}(\mu_{i})^2}\;h&#39;(\eta_{i})^{2}\;
        \boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
        \\
        &amp; =
        \delta_{ij}\;
        \frac{1}{ \phi_{i}\mathcal{V}(\mu_{i})}\;h&#39;(\eta_{i})^{2}\;
        \boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
  \end{align}\]</span></p>
<p>since
<span class="math display">\[\begin{align}
        {\mathrm E}[(Y_{i} - \mu_{i})^{2}]
        &amp; =
        {\mathrm{Var}}[Y_{i} |\boldsymbol{\beta}, \boldsymbol{x}_{i}]
        = \phi_{i}\mathcal{V}(\mu_{i})
        \\
        {\mathrm E}[(Y_{i} - \mu_{i})(Y_{j} - \mu_{j})]
        &amp; =
        {\mathrm{Cov}}[Y_{i}, Y_{j} |\boldsymbol{\beta}, \boldsymbol{x}_{i}]
        = 0
        &amp; &amp; \text{$i\neq j$}
    \end{align}\]</span></p>
<p>so that
<span class="math display" id="eq:vars">\[\begin{equation}
        {\mathrm{Var}}[\boldsymbol{S}(\boldsymbol{\beta})]
        =
        \sum_{i}
        \frac{h&#39;(\eta_{i})^{2}}{ \phi_{i}\mathcal{V}(\mu_{i})} \;
        \boldsymbol{x}_{i}\boldsymbol{x}_{i}^{T}
        \tag{2.12}
\end{equation}\]</span></p>
</div>
<div id="boldsymbolfboldsymbolbeta" class="section level3 hasAnchor" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span><a href="estimation.html#boldsymbolfboldsymbolbeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="an-important-identity" class="section level4 hasAnchor" number="2.6.3.1">
<h4><span class="header-section-number">2.6.3.1</span> An Important Identity<a href="estimation.html#an-important-identity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(\rho = e^l\)</span>, where <span class="math inline">\(l\)</span> is the log-likelihood, so that <span class="math inline">\(\rho = L(\boldsymbol{\beta}) = P_{}\left(\left\{y_{ir_{i}}\right\} |\left\{\boldsymbol{x}_{i}\right\}, \boldsymbol{\beta}\right)\)</span> is the likelihood/probability of the data.
Then
<span class="math display">\[\begin{equation}
        \frac{\partial l}{\partial \boldsymbol{\beta}^{T}}
        =
        \frac{\partial l}{\partial \rho}\frac{\partial \rho}{\partial \boldsymbol{\beta}^{T}}
        =
        \frac{1}{\rho}\frac{\partial \rho}{\partial \boldsymbol{\beta}^{T}}
    \end{equation}\]</span>
and<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
<span class="math display" id="eq:importantidentity">\[\begin{align}
        \frac{\partial^{2} l}{\partial\boldsymbol{\beta}^{T}\partial \boldsymbol{\beta}} &amp; = - \frac{1}{\rho^{2}} \frac{\partial \rho}{\partial \boldsymbol{\beta}^{T}} \frac{\partial
        \rho}{\partial \boldsymbol{\beta}} + \frac{1}{\rho} \frac{\partial^{2} \rho}{
        \partial \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        \\
        &amp; =
        -
        \frac{\partial l}{\partial \boldsymbol{\beta}^{T}}
        \frac{\partial l}{\partial \boldsymbol{\beta}}
        +
        \frac{1}{\rho} \frac{\partial^{2} \rho}{\partial
        \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
         \tag{2.13}
    \end{align}\]</span>
<!-- product rule and chain rule --></p>
<p>The expectation (over the data) of the second term is then
<span class="math display" id="eq:importantidentity2">\[\begin{equation}
        \mathrm{E}
        \left[
            \frac{1 }{ \rho}\frac{\partial^{2} \rho}{ \partial
            \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        \right]
        =
        \int \rho \;\frac{1 }{ \rho} \frac{\partial^{2} \rho}{ \partial
        \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        =
        \int \frac{\partial^{2} \rho}{ \partial \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        =
        \frac{\partial^{2} }{ \partial \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}} \int \rho
        =
        \frac{\partial^{2} }{ \partial \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}\;1
        =
        0
        \tag{2.14}
    \end{equation}\]</span></p>
</div>
<div id="relating-boldsymbolfboldsymbolbeta-and-mathrmvarboldsymbolsboldsymbolbeta" class="section level4 hasAnchor" number="2.6.3.2">
<h4><span class="header-section-number">2.6.3.2</span> Relating <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span> and <span class="math inline">\({\mathrm{Var}}[\boldsymbol{S}(\boldsymbol{\beta})]\)</span><a href="estimation.html#relating-boldsymbolfboldsymbolbeta-and-mathrmvarboldsymbolsboldsymbolbeta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using Equations <a href="estimation.html#eq:importantidentity">(2.13)</a> and <a href="estimation.html#eq:importantidentity2">(2.14)</a>, we have that
<span class="math display">\[\begin{equation}
        \boldsymbol{F}(\boldsymbol{\beta})
        =
        - \mathrm{E}
        \left[
            \frac{\partial^{2}l }{ \partial \boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        \right]
        =
        \mathrm{E}
        \left[
            \frac{\partial l }{ \partial \boldsymbol{\beta}^{T}} \frac{\partial l }{
            \partial\boldsymbol{\beta}}
        \right]
        =
        {\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta})\boldsymbol{S}(\boldsymbol{\beta})^{T}]
        =
        {\mathrm{Var}}[\boldsymbol{S}(\boldsymbol{\beta})]
    \end{equation}\]</span></p>
</div>
<div id="natural-link-1" class="section level4 hasAnchor" number="2.6.3.3">
<h4><span class="header-section-number">2.6.3.3</span> Natural Link<a href="estimation.html#natural-link-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the natural link, recall that <span class="math inline">\(\frac{h&#39;(\eta_i)}{\mathcal{V}(\mu_i)} = 1\)</span>, so that:</p>
<p><span class="math display">\[\begin{eqnarray}
\boldsymbol{S}(\boldsymbol{\beta}) &amp; = &amp; \sum_i  \frac{1}{\phi_i} (y_i - h(\eta_i))\boldsymbol{x}_i \\
\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}) &amp; = &amp; - \boldsymbol{S}&#39;(\boldsymbol{\beta}) = \sum_i \frac{h&#39;(\eta_i)}{\phi_i} \boldsymbol{x}_i\boldsymbol{x}_i^T \\
\boldsymbol{F}(\boldsymbol{\beta}) &amp; = &amp; {\mathrm{Var}}[\boldsymbol{S}(\boldsymbol{\beta})] = \sum_i \frac{h&#39;(\eta_i)}{\phi_i}\boldsymbol{x}_i\boldsymbol{x}_i^T
\end{eqnarray}\]</span></p>
<p>Thus, for the natural link, we see that <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta}) = \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})\)</span>.</p>
</div>
</div>
</div>
<div id="matrix-notation" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Matrix Notation<a href="estimation.html#matrix-notation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the next section, it is useful to establish a condensed, matrix notation for some of the previous quantities, analogous to the matrix notation used for linear models.</p>
<ul>
<li><p>Let <span class="math inline">\(\boldsymbol{Y}\in{\mathbb R}^{n}\)</span> be the random vector with components <span class="math inline">\(Y_{i}\)</span>, the response values. This is exactly the same quantity as in the linear model case.</p></li>
<li><p>Let <span class="math inline">\(\boldsymbol{X}\in{\mathbb R}^{n\times p}\)</span> be the <em>design matrix</em>, the matrix with components <span class="math inline">\(x_{i, a}\)</span>, the value of the <span class="math inline">\(a^{\text{th}}\)</span> component of the predictor vector for the <span class="math inline">\(i^{\text{th}}\)</span> data point. This is exactly the same quantity as in the linear model case.</p></li>
<li><p>Let <span class="math inline">\(\boldsymbol{\mu}\in{\mathbb R}^{n}\)</span> be the vector with components <span class="math inline">\(\mu_{i} = h(\boldsymbol{\beta}^{T}x_{i})\)</span>, so that
<span class="math display">\[\begin{equation}
      \boldsymbol{\mu} = {\mathrm E}[\boldsymbol{Y}]
  \end{equation}\]</span></p></li>
<li><p>Let <span class="math inline">\(\boldsymbol{D}\in {\mathbb R}^{n\times n}\)</span> be the diagonal matrix with components <span class="math inline">\(D_{ii} = h&#39;(\eta_{i})\)</span>.
For example, if <span class="math inline">\(h(\eta) = e^{\eta}\)</span>, then
<span class="math display">\[\begin{equation}
      \boldsymbol{D}
      =
      \begin{pmatrix}
          e^{\boldsymbol{\beta}^{T}x_{1}} &amp; 0 &amp; \cdots &amp; 0 \\
          0                  &amp; \ddots &amp; \ddots &amp; \vdots \\
          \vdots  &amp; \ddots  &amp; \ddots   &amp; 0
          \\
          0  &amp; \cdots &amp; 0 &amp; e^{\boldsymbol{\beta}^{T}x_{n}}
      \end{pmatrix}
  \end{equation}\]</span></p></li>
<li><p>Let <span class="math inline">\(\boldsymbol{\Sigma}\in{\mathbb R}^{n\times n}\)</span> be the covariance matrix <span class="math inline">\(\boldsymbol{Y}\)</span>, with components:
<span class="math display">\[\begin{equation}
      \Sigma_{ij}
      =
      \text{Cov}[Y_{i}, Y_{j}]
      =
      \text{Var}[Y_{i}]\;\delta_{ij}
      =
      \phi_{i}\mathcal{V}(\mu_{i})\;\delta_{ij}
  \end{equation}\]</span>
that is,
<span class="math display">\[\begin{equation}
      \boldsymbol{\Sigma}
      =
      \begin{pmatrix}
          \text{Var}[Y_{1}] &amp; 0 &amp; \cdots &amp; 0 \\
          0                  &amp; \ddots &amp; \ddots &amp; \vdots \\
          \vdots  &amp; \ddots  &amp; \ddots   &amp; 0            \\
          0  &amp; \cdots &amp; 0 &amp; \text{Var}[Y_{n}]
      \end{pmatrix}
      =
      \begin{pmatrix}
          \phi_{1}\mathcal{V}(\mu_{1}) &amp; 0 &amp; \cdots &amp; 0 \\
          0                  &amp; \ddots &amp; \ddots &amp; \vdots \\
          \vdots  &amp; \ddots  &amp; \ddots   &amp; 0            \\
          0  &amp; \cdots &amp; 0 &amp; \phi_{n}\mathcal{V}(\mu_{n})
      \end{pmatrix}
  \end{equation}\]</span></p></li>
</ul>
<div id="score-function-and-fisher-information" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Score Function and Fisher Information<a href="estimation.html#score-function-and-fisher-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that
<span class="math display">\[\begin{align}
        \boldsymbol{S}(\boldsymbol{\beta})
        &amp; =
        \sum_{i}
        \left(
            \frac{y_{i} - \mu_{i}}{ \phi_{i}\mathcal{V}(\mu_{i})}
        \right)\;
        h&#39;(\eta_{i})\;x_{i}
        \\
        \boldsymbol{F}(\boldsymbol{\beta})
        &amp; =
        \sum_{i}
        \frac{h&#39;(\eta_{i})^{2}}{ \phi_{i}\mathcal{V}(\mu_{i})} \;x_{i}x_{i}^{T}
  \end{align}\]</span></p>
<p>In terms of the matrix notation, these become
<span class="math display">\[\begin{align}
        \boldsymbol{S} &amp; = \boldsymbol{X}^{T}\boldsymbol{D}\boldsymbol{\Sigma}^{-1}(\boldsymbol{Y} - \boldsymbol{\mu}) \\
        \boldsymbol{F} &amp; = \boldsymbol{X}^{T}\boldsymbol{D}^{T}\boldsymbol{\Sigma}^{-1}\boldsymbol{D}\boldsymbol{X}
    \end{align}\]</span></p>
</div>
<div id="natural-link-2" class="section level3 hasAnchor" number="2.7.2">
<h3><span class="header-section-number">2.7.2</span> Natural Link<a href="estimation.html#natural-link-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that for the natural link,
<span class="math display">\[\begin{equation}
        \frac{\partial \theta_{i}}{ \partial \eta_{i}}
        =
        \frac{h&#39;(\eta_{i}) }{ \mathcal{V}(\mu_{i})}
        =
        1
    \end{equation}\]</span></p>
<p>Thus
<span class="math display">\[\begin{equation}
        h&#39;(\eta_{i})
        =
        \mathcal{V}(\mu_{i})
        =
        \frac{\text{Var}[Y_{i}] }{ \phi_{i}}
        =
        m_{i}\frac{{\mathrm{Var}}[Y_{i}] }{ \phi}
    \end{equation}\]</span>
if <span class="math inline">\(\phi_{i} = \phi/m_{i}\)</span>.</p>
<p>Now</p>
<ul>
<li>Let <span class="math inline">\(\boldsymbol{G} \in {\mathbb R}^{n \times n}\)</span> be the diagonal matrix with components <span class="math inline">\(m_{i}\delta_{ij}\)</span>, known as the <em>grouping</em> matrix. Then
<span class="math display">\[\begin{equation}
      \boldsymbol{D}
      =
      \frac{1}{\phi} \boldsymbol{G}\boldsymbol{\Sigma}
      =
      \frac{1}{\phi}\boldsymbol{\Sigma} \boldsymbol{G}
  \end{equation}\]</span></li>
</ul>
<p>and thus
<span class="math display">\[\begin{align}
        \boldsymbol{S}(\boldsymbol{\beta}) &amp; = \frac{1}{\phi} \boldsymbol{X}^{T}\boldsymbol{G}(\boldsymbol{Y} - \boldsymbol{\mu}) \\
        \boldsymbol{F}(\boldsymbol{\beta}) &amp; = \frac{1}{\phi^{2}}
        \boldsymbol{X}^{T}\boldsymbol{G}^{T}\boldsymbol{\Sigma}\boldsymbol{G}\boldsymbol{X}
    \end{align}\]</span></p>
</div>
</div>
<div id="iterativesolution" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Iterative Solution of <span class="math inline">\(\boldsymbol{S}(\hat{\boldsymbol{\beta}}) = 0\)</span><a href="estimation.html#iterativesolution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far we have seen how to set up the score equation for the maximum likelihood estimate, and some of its properties, as well as those of the Fisher Information. We now turn to the question of how to solve the score equation. As we have seen, except in rare cases, this cannot be done in closed form, and so we turn to numerical methods, implemented on a computer. We have the same two options here as in the binary regression case. We can try to optimise <span class="math inline">\(l\)</span> directly, or we can attempt to solve the score equation.
There are many algorithms that can be used to perform these tasks.
Here we focus on one: <span style="color: red;">iteratively reweighted least squares (IRLS)</span>, also known as <span style="color: red;">iteratively weighted least squares (IWLS)</span>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p>We start by recalling the Newton-Raphson method for finding the zero of a function. We wish to solve an equation
<span class="math display">\[\begin{equation}
        \boldsymbol{S}(\hat{\boldsymbol{\beta}}) = 0
    \end{equation}\]</span></p>
<p>We then approximate <span class="math inline">\(\boldsymbol{S}\)</span> linearly about some point:
<span class="math display">\[\begin{equation}
        \boldsymbol{S}(\boldsymbol{\beta}_{0} + \delta\boldsymbol{\beta}_{0})
        =
        \boldsymbol{S}(\boldsymbol{\beta}_{0})
        + \frac{\partial \boldsymbol{S}(\boldsymbol{\beta}_{0})}{\partial\boldsymbol{\beta}}\delta\boldsymbol{\beta}_{0}
        + \mathcal{O}(\delta\boldsymbol{\beta}_{0}^{2})
    \end{equation}\]</span></p>
<p>where the reason for the subscript <span class="math inline">\(0\)</span> will become apparent soon. In the case when <span class="math inline">\(\boldsymbol{S}(\boldsymbol{\beta}_{0} + \delta\boldsymbol{\beta}_{0}) = 0\)</span> (such as we are interested in), we have approximately that
<span class="math display" id="eq:solutionnewton">\[\begin{equation}
        \frac{\partial \boldsymbol{S}(\boldsymbol{\beta}_{0})}{\partial\boldsymbol{\beta}}\delta\boldsymbol{\beta}_{0}
        =
        -\boldsymbol{S}(\boldsymbol{\beta}_{0})
        \tag{2.15}
    \end{equation}\]</span>
Now in our case
<span class="math display">\[\begin{equation}
        -\frac{\partial \boldsymbol{S}(\boldsymbol{\beta}_{0})}{\partial\boldsymbol{\beta}}
        =
        \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_{0})
    \end{equation}\]</span>
so Equation <a href="estimation.html#eq:solutionnewton">(2.15)</a> becomes
<span class="math display">\[\begin{equation}
        \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_{0})\delta\boldsymbol{\beta}_{0}
        =
        \boldsymbol{S}(\boldsymbol{\beta}_{0})
    \end{equation}\]</span>
or equivalently
<span class="math display">\[\begin{equation}
        \delta\boldsymbol{\beta}_{0}
        =
        \left(
            \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_{0})
        \right)^{-1}
        \boldsymbol{S}(\boldsymbol{\beta}_{0})
    \end{equation}\]</span></p>
<p>This then gives a new value
<span class="math display">\[\begin{equation}
\boldsymbol{\beta}_{1} = \boldsymbol{\beta}_{0} + \delta\boldsymbol{\beta}_{0}
\end{equation}\]</span>,
and we then iterate:
<span class="math display">\[\begin{align}
        \boldsymbol{\beta}_{m+1}
        &amp; =
        \boldsymbol{\beta}_{m} + \delta\boldsymbol{\beta}_{m}
    \end{align}\]</span>
where
<span class="math display">\[\begin{align}
        \delta\boldsymbol{\beta}_{m}
        &amp; =
        \left(
            \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_{m})
        \right)^{-1}
        \boldsymbol{S}(\boldsymbol{\beta}_{m})
    \end{align}\]</span></p>
<p>Because <span class="math inline">\(\boldsymbol{F}_{\text{obs}}\)</span> is hard to find and hard to invert in general, we approximate it with the expected Fisher Information. This is known as <span style="color: red;">Fisher scoring</span>:
<span class="math display">\[\begin{equation}
        \delta\boldsymbol{\beta}_{m}
        =
        \left(
            \boldsymbol{F}(\boldsymbol{\beta}_{m})
        \right)^{-1}
        \boldsymbol{S}(\boldsymbol{\beta}_{m})
    \end{equation}\]</span></p>
<p>More usefully, we have that
<span class="math display">\[\begin{equation}
        \boldsymbol{F}(\boldsymbol{\beta}_{m})\delta\boldsymbol{\beta}_{m}
        =
        \boldsymbol{S}(\boldsymbol{\beta}_{m})
    \end{equation}\]</span>
or equivalently that
<span class="math display" id="eq:fisheriteration">\[\begin{equation}
        \boldsymbol{F}(\boldsymbol{\beta}_{m})\boldsymbol{\beta}_{m+1}
        =
        \boldsymbol{F}(\boldsymbol{\beta}_{m})\boldsymbol{\beta}_{m}
        +
        \boldsymbol{S}(\boldsymbol{\beta}_{m})
        \tag{2.16}
    \end{equation}\]</span></p>
<p>By defining <span class="math inline">\(\boldsymbol{W} = \boldsymbol{D}^{T}\boldsymbol{\Sigma}^{-1}\boldsymbol{D}\)</span>, we can write
<span class="math display">\[\begin{equation}
        \boldsymbol{F}
        =
        \boldsymbol{X}^{T}\boldsymbol{D}^{T}\boldsymbol{\Sigma}^{-1}\boldsymbol{D}\boldsymbol{X}
        =
        \boldsymbol{X}^{T}\boldsymbol{W}\boldsymbol{X}
    \end{equation}\]</span>
and
<span class="math display">\[\begin{equation}
        \boldsymbol{S}
        =
        \boldsymbol{X}^{T}\boldsymbol{D}\boldsymbol{\Sigma}^{-1}(\boldsymbol{Y} - \boldsymbol{\mu})
        =
        \boldsymbol{X}^{T}\boldsymbol{W}\boldsymbol{D}^{-1}(\boldsymbol{Y} - \boldsymbol{\mu})
    \end{equation}\]</span></p>
<p>Thus we can calculate the right-hand side of Equation <a href="estimation.html#eq:fisheriteration">(2.16)</a> from<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>:
<span class="math display">\[\begin{equation}
        \boldsymbol{F}_{m}\boldsymbol{\beta}_{m}
        +
        \boldsymbol{S}_{m}
        =
        \boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{X}\boldsymbol{\beta}_{m}
        +
        \boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{D}_{m}^{-1}(\boldsymbol{Y} - \boldsymbol{\mu}_{m})
        =
        \boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{\tilde{Y}}_{m}
    \end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
        \boldsymbol{\tilde{Y}}_{m}
        =
        \boldsymbol{X}\boldsymbol{\beta}_{m}
        +
        \boldsymbol{D}_{m}^{-1}(\boldsymbol{Y} - \boldsymbol{\mu}_{m})
    \end{equation}\]</span>
are the so-called <em>working observations</em>.</p>
<p>By replacing the left hand side of Equation <a href="estimation.html#eq:fisheriteration">(2.16)</a> with <span class="math inline">\(\boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{X}\)</span>, we have that
<span class="math display">\[\begin{align}
   (\boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{X}) \boldsymbol{\beta}_{m+1}
   &amp; =
   \boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{\tilde{Y}}_{m}
  \\
          \boldsymbol{\beta}_{m+1}
       &amp; =
        (\boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{X})^{-1}\boldsymbol{X}^{T}\boldsymbol{W}_{m}\boldsymbol{\tilde{Y}}_{m}
  \end{align}\]</span></p>
<p>This sequence of iterated operations is called <span style="color: red;">iteratively re-weighted least squares (IRLS)</span> or <span style="color: red;">iterative weighted least squares (IWLS)</span> <!--. The name can be understood as follows. -->
since each iteration is the solution to the following least squares problem: minimize the quantity <span class="math inline">\(l_{m}(\boldsymbol{\beta})\)</span> with respect to <span class="math inline">\(\boldsymbol{\beta}\)</span>, where
<span class="math display">\[\begin{equation}
        l_{m}(\boldsymbol{\beta})
        =
        (\boldsymbol{\tilde{Y}}_{m} - \boldsymbol{X}\boldsymbol{\beta})^{T}
        \boldsymbol{W}_{m}
        (\boldsymbol{\tilde{Y}}_{m} - \boldsymbol{X}\boldsymbol{\beta})
    \end{equation}\]</span></p>
<p>As a result, <span class="math inline">\(\boldsymbol{W}\)</span> is known as the <em>weight matrix</em>.</p>
<div id="irls-pseudo-code" class="section level3 hasAnchor" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> IRLS Pseudo-Code<a href="estimation.html#irls-pseudo-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that the following is pseudo-code for running IRLS, as without computing <span class="math inline">\(\boldsymbol{\mu}\)</span>, <span class="math inline">\(\boldsymbol{D}\)</span> and <span class="math inline">\(\boldsymbol{W}\)</span> using a specific example this will not run.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="estimation.html#cb1-1" tabindex="-1"></a>IRLS <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, X, phi, epsilon) {</span>
<span id="cb1-2"><a href="estimation.html#cb1-2" tabindex="-1"></a>    <span class="co"># Pick an initial value for hatBeta.</span></span>
<span id="cb1-3"><a href="estimation.html#cb1-3" tabindex="-1"></a>    hatbeta <span class="ot">=</span> <span class="fu">initializeBeta</span>()</span>
<span id="cb1-4"><a href="estimation.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="estimation.html#cb1-5" tabindex="-1"></a>    <span class="co"># Set up convergence.</span></span>
<span id="cb1-6"><a href="estimation.html#cb1-6" tabindex="-1"></a>    converged <span class="ot">=</span> false</span>
<span id="cb1-7"><a href="estimation.html#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="estimation.html#cb1-8" tabindex="-1"></a>    <span class="co"># Loop as long as convergence condition is not satisfied.</span></span>
<span id="cb1-9"><a href="estimation.html#cb1-9" tabindex="-1"></a>    <span class="cf">while</span> not converged loop</span>
<span id="cb1-10"><a href="estimation.html#cb1-10" tabindex="-1"></a>    {</span>
<span id="cb1-11"><a href="estimation.html#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="estimation.html#cb1-12" tabindex="-1"></a>        <span class="co"># Compute mu, D, and Sigma (use h, h&#39;, V as subroutines)</span></span>
<span id="cb1-13"><a href="estimation.html#cb1-13" tabindex="-1"></a>        mu <span class="ot">=</span> <span class="fu">computeMu</span>(hatBeta, X)</span>
<span id="cb1-14"><a href="estimation.html#cb1-14" tabindex="-1"></a>        D <span class="ot">=</span> <span class="fu">computeD</span>(hatBeta, X)</span>
<span id="cb1-15"><a href="estimation.html#cb1-15" tabindex="-1"></a>        Sigma <span class="ot">=</span> <span class="fu">computeSigma</span>(hatBeta, phi)</span>
<span id="cb1-16"><a href="estimation.html#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="estimation.html#cb1-17" tabindex="-1"></a>        <span class="co"># Compute the weight matrix, W.</span></span>
<span id="cb1-18"><a href="estimation.html#cb1-18" tabindex="-1"></a>        W <span class="ot">=</span> <span class="fu">t</span>(D) <span class="sc">%*%</span> <span class="fu">solve</span>(Sigma) <span class="sc">%*%</span> D</span>
<span id="cb1-19"><a href="estimation.html#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="estimation.html#cb1-20" tabindex="-1"></a>        <span class="co"># Compute the working observations, tildeY.</span></span>
<span id="cb1-21"><a href="estimation.html#cb1-21" tabindex="-1"></a>        tildeY <span class="ot">=</span> X <span class="sc">%*%</span> hatBeta <span class="sc">+</span> <span class="fu">solve</span>(D) <span class="sc">%*%</span> (Y <span class="sc">-</span> mu)</span>
<span id="cb1-22"><a href="estimation.html#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="estimation.html#cb1-23" tabindex="-1"></a>        <span class="co"># Compute the new value of hatBeta.</span></span>
<span id="cb1-24"><a href="estimation.html#cb1-24" tabindex="-1"></a>        newHatBeta <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> W <span class="sc">%*%</span> X) <span class="sc">%*%</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> W <span class="sc">%*%</span> tildeY)</span>
<span id="cb1-25"><a href="estimation.html#cb1-25" tabindex="-1"></a></span>
<span id="cb1-26"><a href="estimation.html#cb1-26" tabindex="-1"></a>        <span class="co"># Check whether we have converged.</span></span>
<span id="cb1-27"><a href="estimation.html#cb1-27" tabindex="-1"></a>        converged <span class="ot">=</span> ((<span class="fu">norm</span>(newHatBeta <span class="sc">-</span> hatBeta) <span class="sc">/</span> <span class="fu">norm</span>(hatBeta)) <span class="sc">&lt;=</span> epsilon)</span>
<span id="cb1-28"><a href="estimation.html#cb1-28" tabindex="-1"></a></span>
<span id="cb1-29"><a href="estimation.html#cb1-29" tabindex="-1"></a>        <span class="co"># Store new value of hatBeta ready for next iteration or return.</span></span>
<span id="cb1-30"><a href="estimation.html#cb1-30" tabindex="-1"></a>        hatBeta <span class="ot">=</span> newHatBeta</span>
<span id="cb1-31"><a href="estimation.html#cb1-31" tabindex="-1"></a></span>
<span id="cb1-32"><a href="estimation.html#cb1-32" tabindex="-1"></a>    }</span>
<span id="cb1-33"><a href="estimation.html#cb1-33" tabindex="-1"></a></span>
<span id="cb1-34"><a href="estimation.html#cb1-34" tabindex="-1"></a>    return hatBeta</span>
<span id="cb1-35"><a href="estimation.html#cb1-35" tabindex="-1"></a></span>
<span id="cb1-36"><a href="estimation.html#cb1-36" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="practical-example-dataset-b-us-polio-data" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Practical Example: Dataset B: US Polio Data<a href="estimation.html#practical-example-dataset-b-us-polio-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We start by loading the amended polio data from library <code>gamlss.data</code> as discussed in Section @ref(polio_data).</p>
<!--This dataset is a matrix of count data, giving the monthly number of polio cases in United States from 1970 to 1983.  We wish to convert this into a usable time series.  In other words, we wish to covert this into a matrix with two columns with

- covariate `time` in the first column ranging from 1 to 168, starting with January 1970.
- response `cases` in the second column, indicating the monthly number of polio cases.

We do this as follows -->
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="estimation.html#cb2-1" tabindex="-1"></a><span class="fu">library</span>( <span class="st">&quot;gamlss.data&quot;</span> )</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gamlss.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     sleep</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="estimation.html#cb5-1" tabindex="-1"></a><span class="fu">data</span>( <span class="st">&quot;polio&quot;</span> )</span>
<span id="cb5-2"><a href="estimation.html#cb5-2" tabindex="-1"></a>uspolio <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>( <span class="fu">matrix</span>( <span class="fu">c</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">168</span>, <span class="fu">t</span>( polio ) ), <span class="at">ncol =</span> <span class="dv">2</span> ) )</span>
<span id="cb5-3"><a href="estimation.html#cb5-3" tabindex="-1"></a><span class="fu">colnames</span>( uspolio ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<!-- First, let's plot the data.

```r
plot( uspolio, type = "h" )
```

<div class="figure">
<img src="_main_files/figure-html/plotpolio2-1.png" alt="Plot of monthly reported number of Polio cases in the US between 1970 and 1983." width="672" />
<p class="caption">(\#fig:plotpolio2)Plot of monthly reported number of Polio cases in the US between 1970 and 1983.</p>
</div>

The main question we wish to consider is: _How has Polio incidence changed over time?_
-->
<p>We begin by fitting a Poisson model with a linear time trend.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="estimation.html#cb6-1" tabindex="-1"></a><span class="co"># Poisson model with linear time trend</span></span>
<span id="cb6-2"><a href="estimation.html#cb6-2" tabindex="-1"></a>polio.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>( cases <span class="sc">~</span> time, <span class="at">family =</span> <span class="fu">poisson</span>( <span class="at">link =</span> log ), <span class="at">data =</span> uspolio )</span>
<span id="cb6-3"><a href="estimation.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="estimation.html#cb6-4" tabindex="-1"></a><span class="co"># Look at the summary.</span></span>
<span id="cb6-5"><a href="estimation.html#cb6-5" tabindex="-1"></a><span class="fu">summary</span>( polio.glm )</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time, family = poisson(link = log), data = uspolio)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.626639   0.123641   5.068 4.02e-07 ***
## time        -0.004263   0.001395  -3.055  0.00225 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 333.55  on 166  degrees of freedom
## AIC: 594.59
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>We can then plot the model as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="estimation.html#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), uspolio<span class="sc">$</span>cases, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb8-2"><a href="estimation.html#cb8-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), polio.glm<span class="sc">$</span>fitted)</span></code></pre></div>
<p><img src="_main_files/figure-html/poliopoissonmodelplot-1.png" width="672" /></p>
<p>We can see that this is perhaps unsatisfactory. We explore a linear trend with seasonal (annual) component.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="estimation.html#cb9-1" tabindex="-1"></a><span class="co"># Poisson model with linear trend and seasonal (annual) component</span></span>
<span id="cb9-2"><a href="estimation.html#cb9-2" tabindex="-1"></a>polio1.glm<span class="ot">&lt;-</span> <span class="fu">glm</span>(cases<span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)),</span>
<span id="cb9-3"><a href="estimation.html#cb9-3" tabindex="-1"></a><span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log), <span class="at">data=</span>uspolio)</span>
<span id="cb9-4"><a href="estimation.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="estimation.html#cb9-5" tabindex="-1"></a><span class="fu">summary</span>(polio1.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)), family = poisson(link = log), data = uspolio)
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               0.606612   0.124800   4.861 1.17e-06 ***
## time                     -0.004644   0.001401  -3.315 0.000916 ***
## I(cos(2 * pi * time/12))  0.181254   0.096160   1.885 0.059442 .  
## I(sin(2 * pi * time/12)) -0.423187   0.097590  -4.336 1.45e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 310.72  on 164  degrees of freedom
## AIC: 575.77
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="estimation.html#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), uspolio<span class="sc">$</span>cases, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb11-2"><a href="estimation.html#cb11-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), polio1.glm<span class="sc">$</span>fitted,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/poliopoissonannual-1.png" width="672" /></p>
<p>How about now with a six-monthly component.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="estimation.html#cb12-1" tabindex="-1"></a><span class="co"># Poisson model with linear trend and seasonal (annual + sixmonthly) component</span></span>
<span id="cb12-2"><a href="estimation.html#cb12-2" tabindex="-1"></a>polio2.glm<span class="ot">&lt;-</span> <span class="fu">glm</span>(cases<span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb12-3"><a href="estimation.html#cb12-3" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)), <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log),</span>
<span id="cb12-4"><a href="estimation.html#cb12-4" tabindex="-1"></a><span class="at">data=</span>uspolio)</span>
<span id="cb12-5"><a href="estimation.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="estimation.html#cb12-6" tabindex="-1"></a><span class="fu">summary</span>(polio2.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time + I(cos(2 * pi * time/12)) + I(sin(2 * 
##     pi * time/12)) + I(cos(2 * pi * time/6)) + I(sin(2 * pi * 
##     time/6)), family = poisson(link = log), data = uspolio)
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               0.557241   0.127303   4.377 1.20e-05 ***
## time                     -0.004799   0.001403  -3.421 0.000625 ***
## I(cos(2 * pi * time/12))  0.137132   0.089479   1.533 0.125384    
## I(sin(2 * pi * time/12)) -0.534985   0.115476  -4.633 3.61e-06 ***
## I(cos(2 * pi * time/6))   0.458797   0.101467   4.522 6.14e-06 ***
## I(sin(2 * pi * time/6))  -0.069627   0.098123  -0.710 0.477957    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 288.85  on 162  degrees of freedom
## AIC: 557.9
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="estimation.html#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), uspolio<span class="sc">$</span>cases, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb14-2"><a href="estimation.html#cb14-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), polio2.glm<span class="sc">$</span>fitted,<span class="at">col=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/poliopoissonsizmonthly-1.png" width="672" /></p>
<p>Add in temperature data.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="estimation.html#cb15-1" tabindex="-1"></a><span class="co"># average annual temperature data over the 14 years.</span></span>
<span id="cb15-2"><a href="estimation.html#cb15-2" tabindex="-1"></a>temp_data <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">5.195</span>, <span class="fl">5.138</span>, <span class="fl">5.316</span>, <span class="fl">5.242</span>, <span class="fl">5.094</span>, <span class="fl">5.108</span>, <span class="fl">5.260</span>, <span class="fl">5.153</span>, </span>
<span id="cb15-3"><a href="estimation.html#cb15-3" tabindex="-1"></a>                   <span class="fl">5.155</span>, <span class="fl">5.231</span>, <span class="fl">5.234</span>, <span class="fl">5.142</span>, <span class="fl">5.173</span>, <span class="fl">5.167</span>), <span class="at">each =</span> <span class="dv">12</span> )</span>
<span id="cb15-4"><a href="estimation.html#cb15-4" tabindex="-1"></a><span class="co"># scale the data so that it plots nicely.</span></span>
<span id="cb15-5"><a href="estimation.html#cb15-5" tabindex="-1"></a>scaled_temp <span class="ot">=</span> <span class="dv">10</span> <span class="sc">*</span> (temp_data <span class="sc">-</span> <span class="fu">min</span>(temp_data))<span class="sc">/</span>(<span class="fu">max</span>(temp_data) <span class="sc">-</span> <span class="fu">min</span>(temp_data))</span>
<span id="cb15-6"><a href="estimation.html#cb15-6" tabindex="-1"></a>uspolio<span class="sc">$</span>temp <span class="ot">=</span> scaled_temp</span>
<span id="cb15-7"><a href="estimation.html#cb15-7" tabindex="-1"></a><span class="co"># Plot temperature data against cases data to see interest.</span></span>
<span id="cb15-8"><a href="estimation.html#cb15-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), uspolio<span class="sc">$</span>cases, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb15-9"><a href="estimation.html#cb15-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), uspolio<span class="sc">$</span>temp, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/polioaddtempdata-1.png" width="672" /></p>
<p>Poisson GLM with temp data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="estimation.html#cb16-1" tabindex="-1"></a><span class="co"># Construct GLM.</span></span>
<span id="cb16-2"><a href="estimation.html#cb16-2" tabindex="-1"></a>polio3.glm<span class="ot">&lt;-</span> <span class="fu">glm</span>(cases<span class="sc">~</span>time <span class="sc">+</span> temp <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb16-3"><a href="estimation.html#cb16-3" tabindex="-1"></a><span class="sc">+</span> <span class="fu">I</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>time<span class="sc">/</span><span class="dv">6</span>)) , <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log),</span>
<span id="cb16-4"><a href="estimation.html#cb16-4" tabindex="-1"></a><span class="at">data=</span>uspolio)</span>
<span id="cb16-5"><a href="estimation.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="estimation.html#cb16-6" tabindex="-1"></a><span class="fu">summary</span>(polio.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ time, family = poisson(link = log), data = uspolio)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.626639   0.123641   5.068 4.02e-07 ***
## time        -0.004263   0.001395  -3.055  0.00225 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 343.00  on 167  degrees of freedom
## Residual deviance: 333.55  on 166  degrees of freedom
## AIC: 594.59
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="estimation.html#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), uspolio<span class="sc">$</span>cases, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb18-2"><a href="estimation.html#cb18-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), polio3.glm<span class="sc">$</span>fitted, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/poliopoissontemperature-1.png" width="672" /></p>
<p>Compare to moving average window…</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="estimation.html#cb19-1" tabindex="-1"></a><span class="co"># Compare to simple moving average</span></span>
<span id="cb19-2"><a href="estimation.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="estimation.html#cb19-3" tabindex="-1"></a><span class="co"># Size of averaging window.</span></span>
<span id="cb19-4"><a href="estimation.html#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="estimation.html#cb19-5" tabindex="-1"></a><span class="co"># Try m = 3, 6, 12, 60, 120</span></span>
<span id="cb19-6"><a href="estimation.html#cb19-6" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb19-7"><a href="estimation.html#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="estimation.html#cb19-8" tabindex="-1"></a>MA <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(uspolio<span class="sc">$</span>time))</span>
<span id="cb19-9"><a href="estimation.html#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="estimation.html#cb19-10" tabindex="-1"></a><span class="cf">for</span> (time <span class="cf">in</span> uspolio<span class="sc">$</span>time)</span>
<span id="cb19-11"><a href="estimation.html#cb19-11" tabindex="-1"></a>{</span>
<span id="cb19-12"><a href="estimation.html#cb19-12" tabindex="-1"></a>times <span class="ot">=</span> time<span class="sc">:</span><span class="fu">min</span>(time <span class="sc">+</span> m <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">length</span>(uspolio<span class="sc">$</span>time))</span>
<span id="cb19-13"><a href="estimation.html#cb19-13" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(times)</span>
<span id="cb19-14"><a href="estimation.html#cb19-14" tabindex="-1"></a>sum <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb19-15"><a href="estimation.html#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="estimation.html#cb19-16" tabindex="-1"></a><span class="cf">for</span> (newtime <span class="cf">in</span> times)</span>
<span id="cb19-17"><a href="estimation.html#cb19-17" tabindex="-1"></a>{</span>
<span id="cb19-18"><a href="estimation.html#cb19-18" tabindex="-1"></a>sum <span class="ot">=</span> sum <span class="sc">+</span> uspolio<span class="sc">$</span>cases[newtime]</span>
<span id="cb19-19"><a href="estimation.html#cb19-19" tabindex="-1"></a>}</span>
<span id="cb19-20"><a href="estimation.html#cb19-20" tabindex="-1"></a></span>
<span id="cb19-21"><a href="estimation.html#cb19-21" tabindex="-1"></a>MA[time] <span class="ot">=</span> sum <span class="sc">/</span> m</span>
<span id="cb19-22"><a href="estimation.html#cb19-22" tabindex="-1"></a>}</span>
<span id="cb19-23"><a href="estimation.html#cb19-23" tabindex="-1"></a></span>
<span id="cb19-24"><a href="estimation.html#cb19-24" tabindex="-1"></a></span>
<span id="cb19-25"><a href="estimation.html#cb19-25" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), MA, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb19-26"><a href="estimation.html#cb19-26" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1970</span> <span class="sc">+</span> ((uspolio<span class="sc">$</span>time <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">12</span>), <span class="fl">0.2</span><span class="sc">*</span>uspolio<span class="sc">$</span>temp, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/poliocomparetomovingaverage-1.png" width="672" /></p>
</div>
<div id="estimation-of-phi" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Estimation of <span class="math inline">\(\phi\)</span><a href="estimation.html#estimation-of-phi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is no need to estimate the dispersion <span class="math inline">\(\phi\)</span> in order to estimate <span class="math inline">\(\boldsymbol{\beta}\)</span>, because <span class="math inline">\(\phi\)</span> cancels from the equation <span class="math inline">\(\boldsymbol{S}(\hat{\boldsymbol{\beta}}) = 0\)</span>. However, <span class="math inline">\({\mathrm{Var}}[\hat{\boldsymbol{\beta}}]\)</span> does depend on <span class="math inline">\(\phi\)</span>, as one might expect. If necessary, or of interest, <span class="math inline">\(\phi\)</span> can be estimated via:
<span class="math display">\[\begin{equation}
        \hat{\phi}
        =
        \frac{1}{n - p}
        \sum_{i}
        m_{i}
        \frac{(y_{i} - \hat{\mu}_{i})^{2}}{\mathcal{V}(\hat{\mu}_{i})}
    \end{equation}\]</span></p>
<!-- estimate p parameters to get phi -->
<p>The motivation is that
<span class="math display">\[\begin{equation}
        {\mathrm{Var}}[y_{i}]
        =
        {\mathrm E}[((y_{i} - \mu_{i})^{2})]
        =
        \phi_{i}\mathcal{V}(\mu_{i})
        =
        \frac{\phi}{m_{i}} \mathcal{V}(\mu_{i})
    \end{equation}\]</span></p>
<div id="special-cases" class="section level3 hasAnchor" number="2.10.1">
<h3><span class="header-section-number">2.10.1</span> Special Cases<a href="estimation.html#special-cases" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Two special cases are as follows:</p>
<div id="gaussian" class="section level4 hasAnchor" number="2.10.1.1">
<h4><span class="header-section-number">2.10.1.1</span> Gaussian<a href="estimation.html#gaussian" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When <span class="math inline">\(Y |\boldsymbol{\beta}, x \sim {\mathcal N}(\mu, \sigma^{2})\)</span>, with <span class="math inline">\(m = 1\)</span>, we have
<span class="math display">\[\begin{equation}
        \hat{\phi}
        =
        \frac{1}{n - p}
        \sum_{i}
        (y_{i} - \hat{\mu}_{i})^{2}
        =
        \hat{\sigma}^{2}
    \end{equation}\]</span></p>
</div>
<div id="gamma" class="section level4 hasAnchor" number="2.10.1.2">
<h4><span class="header-section-number">2.10.1.2</span> Gamma<a href="estimation.html#gamma" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When <span class="math inline">\(Y |\boldsymbol{\beta}, x \sim \text{Gamma}(\mu, \sigma^{2})\)</span><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>, we have
<span class="math display">\[\begin{equation}
        \frac{1}{\hat{\nu}}
        =
        \hat{\phi}
        =
        \frac{1}{n - p}
        \sum_{i}
        m_{i}
        \frac{(y_{i} - \hat{\mu}_{i})^{2}}{\hat{\mu}_{i}^{2}}
    \end{equation}\]</span></p>
</div>
</div>
<div id="practical-example-dataset-c-hospital-data" class="section level3 hasAnchor" number="2.10.2">
<h3><span class="header-section-number">2.10.2</span> Practical Example: Dataset C: Hospital Data<a href="estimation.html#practical-example-dataset-c-hospital-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="estimation.html#cb20-1" tabindex="-1"></a><span class="fu">library</span>(npmlreg)</span>
<span id="cb20-2"><a href="estimation.html#cb20-2" tabindex="-1"></a><span class="fu">data</span>(hosp)</span>
<span id="cb20-3"><a href="estimation.html#cb20-3" tabindex="-1"></a>hosp.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(duration<span class="sc">~</span>age<span class="sc">+</span>temp1, <span class="at">data=</span>hosp, <span class="at">family=</span><span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb20-4"><a href="estimation.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="estimation.html#cb20-5" tabindex="-1"></a><span class="fu">summary</span>(hosp.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = duration ~ age + temp1, family = Gamma(link = log), 
##     data = hosp)
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -28.654096  16.621018  -1.724   0.0987 .
## age           0.014900   0.005698   2.615   0.0158 *
## temp1         0.306624   0.168141   1.824   0.0818 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.2690233)
## 
##     Null deviance: 8.1722  on 24  degrees of freedom
## Residual deviance: 5.7849  on 22  degrees of freedom
## AIC: 142.73
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="estimation.html#cb22-1" tabindex="-1"></a><span class="co">#(Dispersion parameter for Gamma family taken to be 0.2690233)</span></span>
<span id="cb22-2"><a href="estimation.html#cb22-2" tabindex="-1"></a><span class="co"># by hand:</span></span>
<span id="cb22-3"><a href="estimation.html#cb22-3" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>(hosp.glm<span class="sc">$</span>df.res)<span class="sc">*</span><span class="fu">sum</span>( (hosp<span class="sc">$</span>duration<span class="sc">-</span>hosp.glm<span class="sc">$</span>fitted)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(hosp.glm<span class="sc">$</span>fitted<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.2690233</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="estimation.html#cb24-1" tabindex="-1"></a><span class="co">#[1]  0.2690233</span></span></code></pre></div>
</div>
</div>
<div id="asymptotic-properties-of-hatboldsymbolbeta" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Asymptotic Properties of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span><a href="estimation.html#asymptotic-properties-of-hatboldsymbolbeta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our context, <em>asymptotic</em> means that <span class="math inline">\(M = \sum_{i = 1}^{n} m_{i}\rightarrow \infty\)</span>. This could be because <span class="math inline">\(n\rightarrow \infty\)</span>, or because the <span class="math inline">\(m_{i}\rightarrow\infty\)</span>, or a combination of both.</p>
<p>Let us denote the true value of <span class="math inline">\(\boldsymbol{\beta}\)</span> by <span class="math inline">\(\boldsymbol{\beta}_{0}\)</span>. In the following, we assume consistency of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>, i.e. that <span class="math inline">\(\hat{\boldsymbol{\beta}}\stackrel{p}{\rightarrow}\boldsymbol{\beta}_{0}\)</span>, meaning convergence in probability, the probability that <span class="math inline">\(||\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}|| \geq \varepsilon\)</span> tends to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\)</span> tends to infinity. We will also denote this by <span class="math inline">\(\hat{\boldsymbol{\beta}}\stackrel{a}{=} \boldsymbol{\beta}\)</span>, and we will abuse notation by also using this to mean <em>tends to asymptotically</em> for expectations.</p>
<p>Asymptotically, <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> will thus be close to <span class="math inline">\(\boldsymbol{\beta}_{0}\)</span>, and we can expand <span class="math inline">\(\boldsymbol{S}\)</span> around it:
<span class="math display" id="eq:expandS">\[\begin{align}
        \boldsymbol{S}(\hat{\boldsymbol{\beta}})
        =
        0
        &amp; \stackrel{a}{=}
        \boldsymbol{S}(\boldsymbol{\beta}_{0})
        +
        \frac{\partial \boldsymbol{S}(\boldsymbol{\beta}_{0})}{\partial \boldsymbol{\beta}^{T}}(\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0})
        \\
        &amp; =
         \boldsymbol{S}(\boldsymbol{\beta}_{0})
        -
        \boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_0) (\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0})
        \tag{2.17}
    \end{align}\]</span>
or equivalently
<span class="math display">\[\begin{equation}
    \hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}
   =
  (\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_0))^{-1} \boldsymbol{S}(\boldsymbol{\beta}_0)
\end{equation}\]</span></p>
<div id="fisher-scoring" class="section level3 hasAnchor" number="2.11.1">
<h3><span class="header-section-number">2.11.1</span> Fisher Scoring<a href="estimation.html#fisher-scoring" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Section <a href="estimation.html#iterativesolution">2.8</a>, we stated that we often use the (expected) Fisher Information in place of the Observed Fisher Information (known as Fisher Scoring). Doing so in the context of asymptotic arguments is acceptable. We can roughly see this as follows:</p>
<!--
Note that 

From Equation \@ref(eq:expandS), we have that
\begin{align}
  \hbeta - \mb{\beta}_{0}
  & = 
  (\mb{F}_{\text{obs}}(\mb{\beta}_0))^{-1} \mb{S}(\mb{\beta}_0)
  \\
  & =
  \left(\frac{1}{n}\mb{F}_{\text{obs}}(\mb{\beta}_0)\right)^{-1} \left(\frac{1}{n}\mb{S}(\mb{\beta}_0)\right)
  \\
  \sqrt{n}(\hbeta - \mb{\beta}_{0})
  & = 
  \left(\frac{1}{n}\mb{F}_{\text{obs}}(\mb{\beta}_0)\right)^{-1} \left(\frac{1}{\sqrt{n}}\mb{S}(\mb{\beta}_0)\right)
\end{align}
-->
<p><span class="math display">\[\begin{equation}
  \frac{1}{n}\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta}_0)
  =
  - \frac{1}{n} \frac{\partial l}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^T} (\boldsymbol{\beta}_0)
  =
  - \frac{1}{n} \sum_{i-1}^n \frac{\partial l_i}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^T} (\boldsymbol{\beta}_0)
  \rightarrow
  - \mathrm{E} \left[\frac{\partial l_i}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^T} (\boldsymbol{\beta}_0) \right]
  =
  F_1(\boldsymbol{\beta})
\end{equation}\]</span>
where <span class="math inline">\(F_1(\boldsymbol{\beta})\)</span> is the expected Fisher Information for a sample of size <span class="math inline">\(1\)</span>, by the law of large numbers as <span class="math inline">\(n \rightarrow \infty\)</span>.
It can be shown that <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta}) = nF_1(\boldsymbol{\beta})\)</span><a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>, thus justifying use of <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span> in the forthcoming asymptotic arguments.</p>
</div>
<div id="expectation" class="section level3 hasAnchor" number="2.11.2">
<h3><span class="header-section-number">2.11.2</span> Expectation<a href="estimation.html#expectation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have
<span class="math display" id="eq:betaintermsofs">\[\begin{equation}
        \hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}
        \stackrel{a}{=}
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;\boldsymbol{S}(\boldsymbol{\beta}_{0})
        \tag{2.18}
    \end{equation}\]</span></p>
<p>Because convergence in probability implies convergence in distribution, this in turn implies that
<span class="math display">\[\begin{equation}
        E[\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}]
        \stackrel{a}{=}
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;E[\boldsymbol{S}(\boldsymbol{\beta}_{0})]
        =
        0
    \end{equation}\]</span></p>
<p>In other words, <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is asymptotically unbiased.</p>
</div>
<div id="variance" class="section level3 hasAnchor" number="2.11.3">
<h3><span class="header-section-number">2.11.3</span> Variance<a href="estimation.html#variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similarly, we have that
<span class="math display">\[\begin{align}
        {\mathrm{Var}}[\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}]
        &amp; =
        {\mathrm E}[(\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0})(\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0})^{T}] \\
        &amp; \stackrel{a}{=}
        {\mathrm E}[\boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;\boldsymbol{S}(\boldsymbol{\beta}_{0})\;\boldsymbol{S}(\boldsymbol{\beta}_{0})^{T}\;
        \boldsymbol{F}^{-T}(\boldsymbol{\beta}_{0})] \\
        &amp; =
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;{\mathrm E}[\boldsymbol{S}(\boldsymbol{\beta}_{0})\;\boldsymbol{S}(\boldsymbol{\beta}_{0})^{T}]\;
        \boldsymbol{F}^{-T}(\boldsymbol{\beta}_{0}) \\
        &amp; =
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;{\mathrm{Var}}[\boldsymbol{S}(\boldsymbol{\beta}_{0})] \;
        \boldsymbol{F}^{-T}(\boldsymbol{\beta}_{0}) \\
        &amp; =
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})
    \end{align}\]</span></p>
<p>where we have used symmetry of <span class="math inline">\(\boldsymbol{F}\)</span>. Thus
<span class="math display" id="eq:varhbeta">\[\begin{equation}
        {\mathrm{Var}}[\hat{\boldsymbol{\beta}}]
        =
        {\mathrm{Var}}[\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}]
        \stackrel{a}{=}
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})
        \tag{2.19}
    \end{equation}\]</span></p>
<p>Note that
<span class="math display">\[\begin{equation}
        \boldsymbol{F}(\boldsymbol{\beta})
        =
        \mathrm{E}
        \left[
            -\frac{\partial^{2} l}{\partial\boldsymbol{\beta}^{T}\partial\boldsymbol{\beta}}
        \right]
    \end{equation}\]</span></p>
<p>so that the variance of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> can be seen as the inverse precision, or the `curvature’, of the log-likelihood function. Note that the greater the curvature, the more precise the inference about <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p>
</div>
<div id="asymptotic-normality" class="section level3 hasAnchor" number="2.11.4">
<h3><span class="header-section-number">2.11.4</span> Asymptotic Normality<a href="estimation.html#asymptotic-normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following is a sketch of the argument of asymptotic normality. We start from
<span class="math display">\[\begin{equation}
        \boldsymbol{S}(\boldsymbol{\beta})
        =
        \sum_{i}
        \boldsymbol{S}_{i}(\boldsymbol{\beta})
    \end{equation}\]</span></p>
<p>which defines the <span class="math inline">\(\boldsymbol{S}_{i}\)</span>. This is a sum of independent random variables, with zero mean and finite variance. As the number of terms in the sum tends to infinity, then under a certain condition, the distribution of the sum converges in distribution to a normal distribution:
<span class="math display">\[\begin{equation}
        \boldsymbol{S}(\boldsymbol{\beta})
        \stackrel{a}{\sim}
        {\mathcal N}(0, \boldsymbol{F}(\boldsymbol{\beta}))
    \end{equation}\]</span></p>
<p>Hence
<span class="math display">\[\begin{equation}
        \hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}
       \stackrel{a}{=}
        \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;\boldsymbol{S}(\boldsymbol{\beta}_{0})
        \stackrel{a}{\sim}
        {\mathcal N}(0, \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0})\;\boldsymbol{F}(\boldsymbol{\beta}_{0})\;\boldsymbol{F}^{-T}(\boldsymbol{\beta}_{0}))
    \end{equation}\]</span></p>
<p>Convergence in probability implies convergence in distribution, so
<span class="math display" id="eq:disthbeta">\[\begin{equation}
        \hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0}
        \stackrel{a}{\sim}
        {\mathcal N}(0, \boldsymbol{F}^{-1}(\boldsymbol{\beta}_{0}))
        \tag{2.20}
    \end{equation}\]</span></p>
<p>This also implies that the Mahalanobis distance between <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> and <span class="math inline">\(\boldsymbol{\beta}_{0}\)</span> is asymptotically chi-square distributed:
<span class="math display" id="eq:distmahalanobishbeta">\[\begin{equation}
        (\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0})^{T}\;\boldsymbol{F}(\boldsymbol{\beta}_{0})\;(\hat{\boldsymbol{\beta}}- \boldsymbol{\beta}_{0})
        \stackrel{a}{\sim}
        \chi^{2}(p)
        \tag{2.21}
    \end{equation}\]</span></p>
</div>
<div id="closing-the-circle" class="section level3 hasAnchor" number="2.11.5">
<h3><span class="header-section-number">2.11.5</span> Closing The Circle<a href="estimation.html#closing-the-circle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Under some regularity conditions,
<span class="math display">\[\begin{equation}
        \boldsymbol{F}^{-1}(\boldsymbol{\beta})
        =
        \left(
            \sum_{i} m_{i} \ldots
        \right)^{-1}
        \rightarrow
        0
    \end{equation}\]</span></p>
<p>as <span class="math inline">\(M\rightarrow\infty\)</span>. Thus <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> converges in distribution to a constant random variable, which means that it converges in probability too, which is what we were assuming.</p>
<p>Equations <a href="estimation.html#eq:varhbeta">(2.19)</a>, <a href="estimation.html#eq:disthbeta">(2.20)</a>, and <a href="estimation.html#eq:distmahalanobishbeta">(2.21)</a> remain valid when <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta}_{0})\)</span> is replaced by <span class="math inline">\(\boldsymbol{F}(\hat{\boldsymbol{\beta}})\)</span>.</p>
</div>
<div id="next-step" class="section level3 hasAnchor" number="2.11.6">
<h3><span class="header-section-number">2.11.6</span> Next Step<a href="estimation.html#next-step" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have seen how to estimate the parameters, and some of their sampling properties (asymptotically), we can move on to how to use these estimates to make inferences: predictions about new values and confidence intervals.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-green1984irl" class="csl-entry">
Green, P. J. 1984. <span>“Iteratively Reweighted Least Squares for Maximum Likelihood Estimation, and Some Robust and Resistant Alternatives.”</span> <em>JRSSB</em> 46 (2): 149–92.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>for the second line, we use the fact that if <span class="math inline">\(f(f^{-1}(z)) = z\)</span>, then <span class="math inline">\(f&#39;(f^{-1}(z)) (f^{-1})&#39;(z) = 1\)</span>, thus <span class="math inline">\((f^{-1})&#39;(z) = \frac{1}{f&#39;(f^{-1}(z))}\)</span> (and take <span class="math inline">\(f=b&#39;\)</span>).<a href="estimation.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Some texts refer to <span class="math inline">\(\boldsymbol{F}_{\text{obs}}(\hat{\boldsymbol{\beta}})\)</span> as the <em>Observed</em> Fisher Information, and to <span class="math inline">\(\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})\)</span> simply as the Fisher Information. Some don’t refer to either of these at all. Just to be clear, we will refer to <span class="math inline">\(\boldsymbol{F}_{\text{obs}}(\boldsymbol{\beta})\)</span> as the Observed Fisher Information and the Expected Fisher Information <span class="math inline">\(\boldsymbol{F}(\boldsymbol{\beta})\)</span> simply as the Fisher Information.<a href="estimation.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Note that <span class="math inline">\(\frac{\partial}{\partial \boldsymbol{\beta}} \frac{1}{\rho(\boldsymbol{\beta})} = - \frac{1}{\rho^2} \frac{\partial \rho}{\partial \boldsymbol{\beta}}\)</span>.<a href="estimation.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>You have cause to be particularly interested in this algorithm as a Durham student. It is on the undergraduate syllabus of nearly every maths degree in the world which includes a large statistical component and some of the important early development was researched by Dr Peter Green when he was a lecturer at Durham: <span class="citation">Green (<a href="#ref-green1984irl">1984</a>)</span>.<a href="estimation.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>subscript <span class="math inline">\(m\)</span> means evaluated using <span class="math inline">\(\boldsymbol{\beta}_{m}\)</span> or derived quantities<a href="estimation.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Recall: that it was shown in Exercise 6.1 how to parameterise the Gamma function in terms of its mean and variance, and we found that <span class="math inline">\(\mathcal{V}(\mu) = \mu^2\)</span>.<a href="estimation.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>See Statistical Inference II lecture notes or prove as exercise. Incidentally, there is much background on Fisher Information in the Statistical Inference II lecture notes, so some of this stuff should just be a review!<a href="estimation.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalised_linear_models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prediction_and_inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-Estimation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
